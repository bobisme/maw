{"id":"bd-10a","title":"Add 'maw ws finalize' to automate clean push workflow","description":"Add a command that automates the full 'merge and push' workflow, handling empty commits automatically.\n\nWhat it does:\n1. Check for empty commits in ancestry of current commit\n2. If found, rebase current commit onto main@origin (or specified base)\n3. Move bookmark to current commit\n4. Push to remote\n\nUsage:\n  maw ws finalize               # Uses main@origin as base\n  maw ws finalize --base trunk  # Custom base\n  maw ws finalize --dry-run     # Show what would happen\n\nAlternative names to consider:\n- maw ws clean-push\n- maw ws publish\n- maw ws release\n\nThis eliminates the manual steps: check for empty commits, rebase, move bookmark, push. It's the natural final step after 'maw ws merge'.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T20:21:18.358775642Z","created_by":"bob","updated_at":"2026-01-28T20:31:46.049404454Z","closed_at":"2026-01-28T20:31:46.049374768Z","close_reason":"Over-engineering. Combines too many steps with varying semantics (rebase is situational). The blessed path is: merge warns about problems, docs explain the fix, agent follows documented steps.","source_repo":".","compaction_level":0,"original_size":0,"labels":["agent-ux","cli"]}
{"id":"bd-10x","title":"Auto-resolve workspace conflicts for excluded paths (.beads/, .crit/)","description":"Feature request from botbox-dev (ref: bd-3lq in botbox project).\n\nProblem: Agents hit merge conflicts in .beads/ and .crit/ constantly because these change on main while workspaces are active. These paths are workspace-independent state that shouldn't conflict.\n\nProposal: Add .mawignore or [workspace] config in .maw.toml to specify paths that auto-resolve from main on merge. Future: use jj sparse --exclude when v2 lands.\n\nAcceptance criteria:\n- Design configuration approach (.mawignore file or .maw.toml section)\n- Implement auto-resolution of conflicts in configured paths during maw ws merge\n- Document the feature\n- Test with .beads/ and .crit/ as example excluded paths","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-02-04T00:05:16.683637437Z","created_by":"maw-dev","updated_at":"2026-02-04T00:14:42.671970995Z","closed_at":"2026-02-04T00:14:42.671946228Z","close_reason":"Completed. Feature merged: auto-resolve conflicts from main during merge. Review cr-tlfk approved by maw-security.","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":1,"issue_id":"bd-10x","author":"maw-dev","text":"Started in workspace frost-kernel (/home/bob/src/maw/.workspaces/frost-kernel)","created_at":"2026-02-04T00:05:44Z"},{"id":2,"issue_id":"bd-10x","author":"maw-dev","text":"Review requested: cr-tlfk, workspace: frost-kernel (/home/bob/src/maw/.workspaces/frost-kernel)","created_at":"2026-02-04T00:10:03Z"}]}
{"id":"bd-10y","title":"Add automatic stale workspace detection","description":"When running workspace commands (list, status), automatically detect stale workspaces and display a warning. Catches stale state early without requiring explicit 'maw ws status' calls.\n\nImplementation:\n- Add check_workspace_staleness() helper function\n- Check stderr of 'jj status' for 'working copy is stale'\n- Add stale check to end of list() and other commands\n- Show warning with fix command\n\nOutput example:\nWARNING: 2 workspace(s) stale: alice, bob\n  Fix: maw ws sync (from workspace) or maw ws jj <name> workspace update-stale\n\nAcceptance criteria:\n- 'maw ws list' warns about stale workspaces\n- Warning includes workspace names and fix command\n- Non-intrusive (just a warning, doesn\\'t block operations)\n- Performance acceptable for typical workspace counts (<10)\n\nConfidence: 75% - Good concept, main risk is performance with many workspaces.\n\nReference: notes/ideas.md (Idea 14)","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-02-04T04:31:31.075157091Z","created_by":"maw-dev","updated_at":"2026-02-04T05:40:33.730791953Z","closed_at":"2026-02-04T05:40:33.730763329Z","close_reason":"Implemented automatic stale workspace detection. Review cr-30a3 approved and merged.","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":3,"issue_id":"bd-10y","author":"maw-dev","text":"Dispatched worker frozen-river (model: haiku) in workspace bold-oracle (/home/bob/src/maw/.workspaces/bold-oracle)","created_at":"2026-02-04T05:26:55Z"},{"id":4,"issue_id":"bd-10y","author":"maw-dev","text":"Resetting to open: worker dispatch was simulated but not actually executed. Workspace bold-oracle still exists but has no changes.","created_at":"2026-02-04T05:33:15Z"},{"id":5,"issue_id":"bd-10y","author":"maw-dev","text":"Dispatched worker green-tower (model: haiku) in workspace electric-forest (/home/bob/src/maw/.workspaces/electric-forest)","created_at":"2026-02-04T05:34:35Z"},{"id":6,"issue_id":"bd-10y","author":"maw-dev","text":"Review requested: cr-30a3","created_at":"2026-02-04T05:38:27Z"}]}
{"id":"bd-11w","title":"TUI: Workspaces panel","description":"List workspaces from jj workspace list. Show name, change ID, description. Indicators for current (@), stale, conflict.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-24T17:32:19.960370147Z","created_by":"bob","updated_at":"2026-01-24T18:31:58.694987222Z","closed_at":"2026-01-24T18:31:58.694966693Z","close_reason":"Completed workspaces panel with stale detection and improved parsing","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-11w","depends_on_id":"bd-328","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-136","title":"Add green checkmarks to maw status for ideal-state items","description":"Add green checkmarks (ANSI green) to `maw status` (multiline) and `--oneline` output for items in their ideal state, so the user can tell at a glance what is good.\n\n## Current output (multiline)\n\n```\n=== maw status ===\nAgent workspaces: 0 (1 total)\nWorking copy changes: none\nUntracked files (git): none\nMain vs origin: up to date\nStale workspace: no\n```\n\n## Desired output (multiline)\n\n```\n=== maw status ===\nAgent workspaces: 0 (1 total)    ✓\nWorking copy changes: none       ✓\nUntracked files (git): none      ✓\nMain vs origin: up to date       ✓\nStale workspace: no              ✓\n```\n\nThe checkmark should be ANSI green (use existing colorize pattern, e.g. `\\x1b[32m`). Only show the checkmark when the value is in its ideal state:\n\n- Agent workspaces: 0 → checkmark\n- Working copy changes: none → checkmark  \n- Untracked files: none → checkmark\n- Main vs origin: up to date → checkmark\n- Stale workspace: no → checkmark\n\nNon-ideal values already have their own indicators (counts, warnings), so no marker needed for those.\n\n## Oneline\n\nFor `--oneline`, append a green checkmark to each key=value pair that is ideal:\n\n```\nws=0✓ changes=0✓ untracked=0✓ main=sync✓ stale=0✓\n```\n\nvs current:\n```\nws=0 changes=0 untracked=0 main=sync stale=0\n```\n\n## Notes\n\n- Use ANSI green (`\\x1b[32m`) for the checkmark character\n- Use literal `✓` (U+2713 CHECK MARK), not emoji\n- Only affects multiline and oneline modes, not --status-bar (which has its own emoji system)\n","status":"closed","priority":3,"issue_type":"feature","owner":"maw-dev","created_at":"2026-02-08T18:23:34.244563298Z","created_by":"maw-dev","updated_at":"2026-02-08T18:26:04.412131763Z","closed_at":"2026-02-08T18:26:04.412097198Z","close_reason":"Added green checkmarks to multiline and --oneline status output for ideal-state items.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-162","title":"add jj_cwd() helper to workspace.rs","description":"Add a pub(crate) jj_cwd() function that returns ws/default/ if it exists, otherwise repo root. All modules (push, status, workspace, doctor) need this pattern. Currently each module re-implements it ad-hoc. Single source of truth prevents future bugs.","status":"closed","priority":1,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-08T03:37:04.553089648Z","created_by":"maw-dev","updated_at":"2026-02-08T03:53:13.067558881Z","closed_at":"2026-02-08T03:53:13.067532712Z","close_reason":"Added jj_cwd() helper to workspace.rs — returns ws/default/ in v2 bare repos, falls back to root for v1. Used by all commands.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-16f","title":"Implement workspace create command","description":"maw workspace create <name> - replaces shell script functionality, creates .workspaces/<name> with jj workspace add","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-24T16:04:25.526886732Z","created_by":"bob","updated_at":"2026-01-24T16:06:37.815438015Z","closed_at":"2026-01-24T16:06:37.815418619Z","close_reason":"Implemented in initial scaffold","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-16f","depends_on_id":"bd-3ng","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-16j","title":"Merge leaves default working copy disconnected from work commits","description":"After 'maw ws merge <ws> --destroy -f', work commits exist in jj history but default's working copy isn't descended from them. Project root ends up empty.\n\njj log shows work commits on separate branch from default@:\n  ○ ytrymmyx  test(bd-203): Add tests for status endpoint\n  ○ pupsmryx  feat(bd-1jk): Add JSON validation middleware\n  @ wsrmqkzx  (no description set)  ← default working copy (empty!)\n  ◆ zzzzzzzz  root()\n\nReported by botbox-dev from eval env /tmp/tmp.9NpmXrdq5A, workspace was brave-crane.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-29T23:41:50.960270726Z","created_by":"bob","updated_at":"2026-01-29T23:47:54.034533908Z","closed_at":"2026-01-29T23:47:54.034504222Z","close_reason":"Fixed: merge now resolves repo root (not workspace root) and runs all jj commands from default workspace context. When run from inside a workspace, jj root returns the workspace path, causing jj new to move the wrong workspace's working copy. Added repo_root() that walks up from jj root to find the directory containing .workspaces/, ensuring merge always operates on the default workspace.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1b1","title":"Improve error messages with actionable suggestions","description":"Errors like 'jj workspace add failed' don't help. Include stderr from jj, suggest fixes.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-24T16:28:50.914277486Z","created_by":"bob","updated_at":"2026-01-24T16:32:26.103281656Z","closed_at":"2026-01-24T16:32:26.103265656Z","close_reason":"Deferring - will add if needed through real use","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1b3","title":"Detect empty/undescribed commits after merge","description":"After maw ws merge creates the merge commit, check for empty or undescribed commits in the ancestry between main@origin and the merge. If found, warn immediately with the exact fix command (jj rebase). This shifts detection from push-time (confusing jj error) to merge-time (actionable maw warning).","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T20:32:00.800872884Z","created_by":"bob","updated_at":"2026-01-28T20:43:35.345815134Z","closed_at":"2026-01-28T20:43:35.345792291Z","close_reason":"v0.4.0: merge now detects undescribed commits and warns with fix commands. Agent template updated with push blocker guidance.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1bi","title":"maw ws jj should detect and handle stale workspaces","description":"Feedback from botty-dev: When workspace is stale, 'maw ws jj' fails without a clear error. Should either auto-detect and offer to update, or give clearer error message pointing to 'jj workspace update-stale' or 'maw ws sync'.\n\nAcceptance criteria:\n- maw ws jj detects when workspace is stale (jj returns stale error)\n- Provides clear error message explaining the issue\n- Suggests running 'maw ws sync' to fix\n- Optionally: offer --auto-sync flag to automatically run sync first","status":"closed","priority":3,"issue_type":"feature","owner":"maw-dev","created_at":"2026-02-05T21:08:44.754340454Z","created_by":"maw-dev","updated_at":"2026-02-05T21:15:56.678269466Z","closed_at":"2026-02-05T21:15:56.678241374Z","close_reason":"Merged: stale workspace detection in maw ws jj","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":7,"issue_id":"bd-1bi","author":"maw-dev","text":"Dispatched worker violet-aspen (model: sonnet) in workspace electric-otter (/home/bob/src/maw/.workspaces/electric-otter)","created_at":"2026-02-05T21:09:29Z"},{"id":8,"issue_id":"bd-1bi","author":"maw-dev","text":"Progress: Completed implementation. Added warn_if_stale() function that checks for stale workspace before running jj commands and prints helpful warning with fix command. Build and tests pass.","created_at":"2026-02-05T21:13:01Z"},{"id":9,"issue_id":"bd-1bi","author":"maw-dev","text":"Review requested: cr-3dru (combined with bd-3m9)","created_at":"2026-02-05T21:13:33Z"}]}
{"id":"bd-1cj","title":"Add maw doctor command","description":"Check for required tools (jj, optionally botbus, beads) and give helpful output about what's missing or misconfigured","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-24T16:34:58.688282631Z","created_by":"bob","updated_at":"2026-01-24T16:36:13.484310601Z","closed_at":"2026-01-24T16:36:13.484289622Z","close_reason":"Added doctor command checking jj, botbus, beads, and repo status","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1cl","title":"crit events.jsonl truncation during workspace merge causes lost reviews","description":"Feedback from botbus-dev: crit events.jsonl was truncated during workspace merge, causing review cr-5v5r to be lost. The crit warning was 'events.jsonl truncated (expected >=34 lines, found 26). Rebuilding projection.' This may be related to concurrent operations from multiple jj workspaces.\n\nRelated to earlier report: Review cr-q947 was lost during workflow.\n\nRoot cause investigation needed:\n- Is this a crit bug or a maw workspace sync issue?\n- Are concurrent jj operations corrupting the events file?\n\nAcceptance criteria:\n- Identify root cause of events.jsonl truncation\n- If maw-related: fix workspace handling\n- If crit-related: file bug with crit project\n- Prevent reviews from being silently lost","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-03T21:51:22.098760476Z","created_by":"maw-dev","updated_at":"2026-02-04T15:19:44.382776343Z","closed_at":"2026-02-04T15:04:59.787256912Z","close_reason":"Crit issue resolved. Detection/recovery (truncation detection, content hash, orphan backup) is the correct solution. Moving events.jsonl outside repo was rejected - reviews must travel with code.","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":10,"issue_id":"bd-1cl","author":"maw-dev","text":"Investigated: This is a crit issue, not maw. Filed bd-2m6 in botcrit repo. Blocking until crit fixes the root cause.","created_at":"2026-02-03T21:52:25Z"},{"id":11,"issue_id":"bd-1cl","author":"Bob","text":"Resolved: crit detection/recovery mechanisms (truncation detection, content hash, orphan backup) are the correct solution. Moving events.jsonl outside the repo was rejected as it violates crit's core design principle that reviews travel with code. Lost reviews can be recovered via .crit/orphaned-reviews-*.json and jj file annotate.","created_at":"2026-02-04T15:04:49Z"},{"id":12,"issue_id":"bd-1cl","author":"Bob","text":"Filed botcrit bd-3u7 for architectural re-evaluation. Proposed fix: event log per review instead of single events.jsonl. This would eliminate concurrent write issues and merge conflicts by design.","created_at":"2026-02-04T15:19:44Z"}]}
{"id":"bd-1cp","title":"Add repo-understanding commands to agent instructions","description":"Add an 'Understanding the Repo' section to the maw_instructions() template in agents.rs with 'jj log' and 'jj log -r working_copies()'. Without these, agents are blind to the commit graph and what other agents are doing.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T16:56:46.754998054Z","created_by":"bob","updated_at":"2026-01-28T16:57:35.775281575Z","closed_at":"2026-01-28T16:57:35.775253823Z","close_reason":"Added Session Start section and jj log commands to agent instructions template in agents.rs","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1e7","title":".beads/issues.jsonl merge conflicts during workspace merge","description":".beads/issues.jsonl gets merge conflict markers during workspace merge. The file changes in both the workspace (agent updates bead status) and default (br sync writes), creating jj conflicts.\n\nThis blocks br commands until resolved manually.\n\nReported by claude during agent-loop.sh eval.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-02-03T20:58:31.988756169Z","created_by":"maw-dev","updated_at":"2026-02-03T20:59:50.662331958Z","closed_at":"2026-02-03T20:59:50.662310779Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1e8","title":"Stale warning should include workspace name in fix command","description":"The stale workspace warning from warn_if_stale() currently prints:\n\n  To fix: maw ws sync\n\nIt should include the specific workspace name:\n\n  To fix: maw ws sync <name>\n\nAgents copy-paste commands from output. The generic form requires them to figure out the workspace name and type it, wasting a tool call.","status":"closed","priority":3,"issue_type":"bug","owner":"maw-dev","created_at":"2026-02-05T22:24:30.280617836Z","created_by":"maw-dev","updated_at":"2026-02-05T22:30:55.414405881Z","closed_at":"2026-02-05T22:30:55.414358271Z","close_reason":"Added workspace name to stale warning in warn_if_stale, attach, and print_status_text","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":13,"issue_id":"bd-1e8","author":"maw-dev","text":"Implementation pointer: warn_if_stale(name, path) in src/workspace.rs already receives the workspace name parameter. Just change the eprintln from 'maw ws sync' to format 'maw ws sync {name}'.","created_at":"2026-02-05T22:25:33Z"}]}
{"id":"bd-1eb","title":"Don't destroy workspaces on merge conflict","description":"maw ws merge --all --destroy will delete workspaces even when merge has conflicts, potentially losing work.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-24T16:28:47.069846799Z","created_by":"bob","updated_at":"2026-01-24T16:30:09.556566661Z","closed_at":"2026-01-24T16:30:09.556536384Z","close_reason":"Merge now refuses to destroy workspaces when conflicts are detected","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1gp","title":"Rename .workspaces/ to ws/","description":"Change the workspace directory from .workspaces/ to ws/.\n\nCode changes:\n- workspaces_dir() in src/workspace.rs: .join(\".workspaces\") → .join(\"ws\")\n- .gitignore template in src/init.rs: .workspaces/ → ws/\n- All path validation, prune, status code that references .workspaces\n- Output strings that mention .workspaces path\n\nThis is the smallest change and foundation for everything else. Must update tests and verify maw ws create/destroy/list/status all work with the new path.\n\nParent epic: bd-z68","status":"closed","priority":2,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T21:48:32.780213493Z","created_by":"maw-dev","updated_at":"2026-02-07T22:03:38.107709300Z","closed_at":"2026-02-07T22:03:38.107675797Z","close_reason":"Renamed .workspaces/ to ws/ throughout codebase","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1hd","title":"resolve_divergent fails when both copies are non-empty","description":"## Problem\n\nresolve_divergent_working_copy() only auto-resolves when exactly one divergent copy is non-empty and the rest are empty. When BOTH copies are non-empty, it gives up and leaves the agent to manually resolve. This costs ~6 tool calls and involves confusing jj operations (abandon, edit, squash) that agents frequently get wrong.\n\n## Observed in Production\n\nbotcrit-dev session (2026-02-07) hit this in the calm-phoenix workspace:\n\n1. Agent worked in calm-phoenix, editing src/cli/commands/reviews.rs and src/projection/mod.rs\n2. Agent created a crit review, adding .crit/reviews/cr-kex3/events.jsonl to the working copy\n3. Another workspace merged, making calm-phoenix stale\n4. `maw ws sync --all` ran `jj workspace update-stale`, creating divergent copies:\n   - Copy 0 (3c684a4b): source changes + .crit review file (301 insertions -- superset)\n   - Copy 1 (bb27f00f, marked @): source changes only (no .crit file -- subset)\n5. Auto-resolve detected both non-empty, printed \"Detected 2 divergent copies\" but did not resolve\n6. Agent manually resolved with ~6 extra tool calls:\n   - Inspected both copies with `maw ws jj calm-phoenix diff -r <commit> --stat` (x2)\n   - Abandoned bb27f00f (the @), which orphaned the workspace pointer to a new empty commit\n   - Had to `jj edit qvttxwnk` to point workspace back at the correct commit\n   - Tried to abandon the orphaned empty commit (already gone -- error)\n   - Eventually merged, but `maw ws merge` adopted the wrong (empty) commit, pushed an empty \"wip\" commit, then had to manually `jj bookmark set main -r <correct>` and `jj git push`\n\nThe cascading failure (wrong copy abandoned -> orphaned pointer -> empty merge -> wrong push) is the worst-case agent UX scenario.\n\n## Why Both Copies Are Non-Empty\n\nAfter `jj workspace update-stale`, jj rebases the workspace commit onto the updated parent. This creates two divergent copies of the same change:\n- The rebased copy (becomes @): has the source code changes rebased onto the new parent\n- The original copy: has the same source code changes on the old parent\n\nBoth copies carry the same source code changes, so neither is empty. But they can differ:\n- Tool-generated files (.crit reviews, .beads, etc.) may appear in one copy but not the other, depending on when they were created relative to the stale event\n- Identical content on different parents: Even with identical diffs, the tree hashes differ because the parent differs\n\nThe \"one empty, one non-empty\" case that current code handles happens when the workspace had changes AND the rebase produces a new commit that starts fresh (e.g., after a conflicting rebase that drops content). The \"both non-empty\" case is arguably MORE common in real usage where the rebase cleanly replays changes.\n\n## Proposed Resolution Strategy\n\nAfter update-stale, @ is always the rebased copy on the structurally correct (updated) parent. Non-@ copies are on stale parents. Resolution should prefer @:\n\n### Phase 1: Tree comparison (handles the common identical-content case)\n1. Get the tree/diff of @ and each non-@ copy\n2. If diffs are identical (same file changes) -> abandon non-@ copies silently\n   - This is the most common case: rebase cleanly replays changes, producing identical content on a new parent\n   - Use `jj diff -r <commit>` output comparison, not tree hashes (trees differ because parents differ)\n\n### Phase 2: Superset detection (handles the tool-generated-files case)\n1. Get the set of changed files in @ and non-@\n2. If non-@'s changed files are a subset of @'s -> abandon non-@ (@ has everything)\n3. If @'s changed files are a subset of non-@'s -> squash non-@ into @, then abandon non-@\n   - This handles the botcrit-dev case: @ had source changes, non-@ had source + .crit file\n4. If neither is a subset (overlapping but different) -> warn, don't auto-resolve\n\n### Phase 3: Fallback with actionable guidance\nIf auto-resolve cannot handle it, print:\n- Which copy is @ and which is non-@\n- File-level summary of what each copy has\n- Exact commands to resolve manually\n- Warning that abandoning @ will orphan the workspace pointer (suggest `jj squash --from <non-@> --into @` instead)\n\n## Edge Cases to Handle\n\n1. 3+ divergent copies: Pairwise comparison, abandon all that are subsets of @\n2. Immutable copies: If a non-@ copy was pushed, it cannot be abandoned -- warn and skip\n3. Workspace pointer after abandon: If @ is abandoned, the workspace pointer moves to a new empty commit. The resolution must NEVER abandon @; instead, squash non-@ content INTO @\n4. Conflicting squash: `jj squash --from <non-@> --into @` might produce conflicts. If so, warn instead of proceeding\n5. Working copy snapshot timing: jj snapshots the working copy on each operation. Ensure the comparison happens after both copies have been fully snapshotted\n\n## Additional UX Issues Observed\n\n- The \"outside your workspace\" warning (warn_if_targeting_other_commit) fires on every abandon/edit command the agent uses during manual recovery, adding noise. Consider suppressing this warning when the target is a divergent copy of the workspace's own change.\n- After abandoning a divergent copy of @, the workspace pointer silently moves to a new empty commit with no explanation. This is a jj behavior, but maw should detect and handle it.\n- `maw ws merge` later adopted the empty workspace commit instead of the actual work. The merge command should check for empty working copy commits that have non-empty divergent siblings and warn or auto-resolve before merging.\n\n## Acceptance Criteria\n\n- [ ] Both-non-empty divergent copies with identical diffs are auto-resolved (abandon non-@ copies)\n- [ ] Both-non-empty where one is a superset: superset content is preserved in @\n- [ ] @ is never abandoned (prevents orphaned workspace pointer)\n- [ ] Clear output explaining what was resolved and why\n- [ ] Eval scenario S5 still passes; add a variant where both copies are non-empty","status":"closed","priority":1,"issue_type":"bug","owner":"maw-dev","created_at":"2026-02-07T21:00:58.462507081Z","created_by":"maw-dev","updated_at":"2026-02-08T04:12:50.551933877Z","closed_at":"2026-02-08T04:12:50.551913549Z","close_reason":"Rewrote resolve_divergent_working_copy: handles both-non-empty via diff comparison (identical→abandon), file subset detection (subset→abandon, superset→squash into @), never abandons @. JJ_EDITOR=true prevents editor hang on squash.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1jy","title":"TUI: Details panel","description":"Context-sensitive detail view. Show workspace info, commit details, or issue details based on selection.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T17:32:21.769028708Z","created_by":"bob","updated_at":"2026-01-24T18:31:57.459437629Z","closed_at":"2026-01-24T18:31:57.459419275Z","close_reason":"Implemented context-sensitive details panel with file changes display","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1jy","depends_on_id":"bd-328","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-1ka","title":"MawConfig::load falls back to ws/default/.maw.toml","status":"closed","priority":1,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T23:14:47.292391322Z","created_by":"maw-dev","updated_at":"2026-02-07T23:45:56.943403551Z","closed_at":"2026-02-07T23:45:56.943375448Z","close_reason":"Shipped in v0.26.1 — MawConfig::load falls back to ws/default/.maw.toml","source_repo":".","compaction_level":0,"original_size":0,"labels":["cleanup","v2"]}
{"id":"bd-1lt","title":"TUI: Workspace actions (create/destroy/sync/merge)","description":"Implement c/d/s/m/M keybindings. Create and destroy popups with confirmation. Merge popup with workspace selection.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-24T17:32:24.397239136Z","created_by":"bob","updated_at":"2026-01-24T18:35:23.082597099Z","closed_at":"2026-01-24T18:35:23.082573294Z","close_reason":"Implemented workspace actions (create/destroy/sync/merge) with popups and terminal editing shortcuts","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1lt","depends_on_id":"bd-11w","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-1op","title":"Implement workspace destroy command","description":"maw workspace destroy <name> - jj workspace forget + rm -rf","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T16:04:26.329493560Z","created_by":"bob","updated_at":"2026-01-24T16:06:37.821788637Z","closed_at":"2026-01-24T16:06:37.821762969Z","close_reason":"Implemented in initial scaffold","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1op","depends_on_id":"bd-3ng","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-1te","title":"Add maw upgrade command for v1 → v2 migration","description":"New subcommand that converts a v1 (.workspaces/) repo to v2 (ws/, bare root, coord workspace).\n\nSteps:\n1. Preflight: verify jj repo, warn about active workspaces, check uncommitted changes\n2. Auto-commit any uncommitted changes as WIP\n3. Destroy existing agent workspaces (or move them)\n4. Create ws/ directory\n5. Create ws/coord, rebase onto main\n6. jj workspace forget default\n7. git config core.bare true\n8. Clean root source files\n9. Update .gitignore (.workspaces/ → ws/)\n10. Verify: jj status → 'No working copy', workspace list shows coord\n\nAlso ship a standalone bash script (notes/upgrade-v1-to-v2.sh) for repos that don't have the new binary yet.\n\nSafety:\n- Refuse to run if already v2 (ws/ exists)\n- Refuse to run if there are uncommitted changes without --force\n- Print every step as it happens\n- Final verification with clear pass/fail\n\nDepends on: bd-1gp (ws/ rename), bd-323 (coord concept)\nParent epic: bd-z68","status":"closed","priority":2,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T21:49:21.188532022Z","created_by":"maw-dev","updated_at":"2026-02-07T22:10:40.227257975Z","closed_at":"2026-02-07T22:10:40.227225695Z","close_reason":"upgrade.rs v1→v2 migration complete","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1te","depends_on_id":"bd-1gp","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"bd-1te","depends_on_id":"bd-323","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-1tm","title":"jj git push output unclear - need confirmation that push succeeded","description":"Feedback from botbus-dev: 'jj git push' output says 'Changes to push' but it's unclear if push actually happened. Need to verify with 'git log origin/main --oneline -1' each time. Would appreciate clearer feedback from jj commands.\n\nAcceptance criteria:\n- maw docs explain jj push output behavior\n- OR maw provides a wrapper command that confirms push success\n- Clear guidance on how to verify a push succeeded","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-02-03T21:51:18.266181063Z","created_by":"maw-dev","updated_at":"2026-02-03T22:02:53.107756688Z","closed_at":"2026-02-03T22:02:53.107722724Z","close_reason":"Implemented documentation improvements explaining jj push behavior. Merged via cr-t99n.","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":14,"issue_id":"bd-1tm","author":"maw-dev","text":"Started in workspace cosmic-kernel (/home/bob/src/maw/.workspaces/cosmic-kernel)","created_at":"2026-02-03T21:52:44Z"},{"id":15,"issue_id":"bd-1tm","author":"maw-dev","text":"Progress: Implemented documentation improvements:\n- Enhanced CLAUDE.md push section with clear explanation that jj reports what it pushed (not preview)\n- Added verification commands to compare local and remote commit hashes\n- Updated jj_intro.rs and agents.rs with same clarifications\n- Added troubleshooting entry for push confirmation uncertainty\nBuild and tests pass.","created_at":"2026-02-03T21:54:10Z"},{"id":16,"issue_id":"bd-1tm","author":"maw-dev","text":"Review requested: cr-t99n, workspace: cosmic-kernel (/home/bob/src/maw/.workspaces/cosmic-kernel)","created_at":"2026-02-03T21:54:28Z"}]}
{"id":"bd-1uh","title":"Add maw status --status-bar/--mouth","description":"Add status-bar output for starship (face + open workspace count + sync warning) and optional --mouth emoji.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T20:04:46.387269333Z","created_by":"bob","updated_at":"2026-02-01T20:05:35.483622754Z","closed_at":"2026-02-01T20:05:35.483544747Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1wn","title":"fix maw push from bare root","description":"maw push fails with 'working copy is stale' when run from bare root. All jj commands in push.rs use .current_dir(&root) but root has no workspace in v2. Need to use jj_cwd (ws/default/) for all jj command invocations.","status":"closed","priority":1,"issue_type":"bug","owner":"maw-dev","created_at":"2026-02-08T03:36:59.677709284Z","created_by":"maw-dev","updated_at":"2026-02-08T03:53:14.212856103Z","closed_at":"2026-02-08T03:53:14.212830125Z","close_reason":"push.rs now uses jj_cwd() for all jj commands. Works from bare root.","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1wn","depends_on_id":"bd-162","type":"blocks","created_at":"2026-02-08T03:37:10.202685434Z","created_by":"maw-dev","metadata":"{}","thread_id":""}]}
{"id":"bd-1wu","title":"clean up README","description":"remove open questions, test notes. make sure it's up-to-date","status":"closed","priority":2,"issue_type":"chore","created_at":"2026-01-24T16:37:49.754606767Z","created_by":"bob","updated_at":"2026-01-24T16:39:09.812523201Z","closed_at":"2026-01-24T16:39:09.812498885Z","close_reason":"Rewrote README with current commands, removed outdated content","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1x1","title":"Update 'maw agents show' with push workflow guidance","description":"The current 'Pushing to Remote' section in maw agents show is incomplete and doesn't mention the empty commit issue.\n\nReplace it with:\n- Instructions to check for empty commits before push\n- Steps to rebase merge commits onto main@origin to clean ancestry\n- Alternative approach of rebasing feature branches before merging\n- Explanation of why MAW creates empty setup commits and why they block push\n\nReal-world problem: After merging workspaces, 'jj git push' fails with 'Won't push commit X since it has no description'. Agents need clear guidance on handling this.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T20:21:01.438718248Z","created_by":"bob","updated_at":"2026-01-28T20:43:35.359101675Z","closed_at":"2026-01-28T20:43:35.359077219Z","close_reason":"v0.4.0: merge now detects undescribed commits and warns with fix commands. Agent template updated with push blocker guidance.","source_repo":".","compaction_level":0,"original_size":0,"labels":["agent-ux","docs"]}
{"id":"bd-1yi","title":"maw init should generate default .maw.toml","description":"Add .maw.toml generation to maw init command with default auto_resolve_from_main config for .beads/** and .crit/**","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-02-04T00:34:25.481118344Z","created_by":"bob","updated_at":"2026-02-04T00:35:10.467070763Z","closed_at":"2026-02-04T00:35:10.467035667Z","close_reason":"Implemented in init.rs - maw init now creates .maw.toml with default auto_resolve_from_main config","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1zd","title":"maw ws sync loses work via divergent commits","description":"When a workspace has uncommitted changes and becomes stale, maw ws sync rebases the workspace commit but can create divergent forks. The workspace ends up pointing to an empty version of the commit while the agent's actual work is in a different fork.\n\nObserved in botbus-dev session:\n1. Agent makes changes in crystal-gateway workspace\n2. Workspace becomes stale (another workspace modified shared history)\n3. Agent runs maw ws sync\n4. Sync creates divergent commit (qmvknour/0 has work, qmvknour/2 is empty)\n5. Workspace points to empty version — agent's work appears lost\n6. Agent must manually recover with jj squash --from qmvknour/0 --into @-\n\nThis happened twice in one session (fierce-viper and crystal-gateway).\n\nFix: After sync, detect if the workspace commit became divergent. If so, auto-resolve by keeping the version with changes (non-empty diff) and abandoning the empty one.","status":"closed","priority":1,"issue_type":"bug","owner":"maw-dev","created_at":"2026-02-05T22:24:28.998549981Z","created_by":"maw-dev","updated_at":"2026-02-05T22:30:55.477404212Z","closed_at":"2026-02-05T22:30:55.477372473Z","close_reason":"Added resolve_divergent_working_copy() that auto-detects and resolves divergent commits after sync","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":17,"issue_id":"bd-1zd","author":"maw-dev","text":"Implementation pointers: sync logic is in src/workspace.rs — search for fn sync and WorkspaceCommands::Sync. jj workspace update-stale is what sync calls under the hood. After sync completes, check jj log for (divergent) markers on the workspace commit. To detect: run jj log -r 'working_copies()' and check if any commit has divergent annotation. To resolve: compare the divergent forks with jj diff -r <id>/0 and jj diff -r <id>/1, keep the non-empty one, jj abandon the other. The key is doing this automatically in the sync command after jj workspace update-stale returns.","created_at":"2026-02-05T22:25:33Z"}]}
{"id":"bd-22v","title":"Add --all flag to maw ws sync","description":"Add --all flag to maw ws sync to sync all workspaces at once, useful after pulling changes that affect multiple workspaces.\n\nImplementation:\n- Add --all flag to Sync command\n- Loop through all workspaces from 'jj workspace list'\n- Check each for staleness, sync if needed\n- Report results: synced, already current, errors\n\nAcceptance criteria:\n- 'maw ws sync --all' syncs all workspaces\n- Reports which workspaces were synced vs already current\n- Handles errors gracefully (one workspace failure doesn't block others)\n- Works correctly with default workspace\n\nConfidence: 90% - Simple, useful feature with clear implementation.\n\nReference: notes/ideas.md (Idea 29)","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-02-04T04:30:08.547131398Z","created_by":"maw-dev","updated_at":"2026-02-04T04:44:38.325914767Z","closed_at":"2026-02-04T04:44:38.325899348Z","close_reason":"Completed. Added --all flag to maw ws sync with defense-in-depth validation for workspace names from jj output. Security review passed (LGTM from maw-security). Pushed to main.","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":18,"issue_id":"bd-22v","author":"maw-dev","text":"Started in workspace amber-fox (/home/bob/src/maw/.workspaces/amber-fox)","created_at":"2026-02-04T04:32:30Z"},{"id":19,"issue_id":"bd-22v","author":"maw-dev","text":"Implementation complete. Changes:\n- Added --all flag to Sync command in WorkspaceCommands enum\n- Added sync_all() function that iterates through all workspaces\n- Tests compile and pass\n- Manual testing confirms feature works correctly","created_at":"2026-02-04T04:34:42Z"},{"id":20,"issue_id":"bd-22v","author":"maw-dev","text":"Review requested: cr-2vft, workspace: amber-fox (/home/bob/src/maw/.workspaces/amber-fox)","created_at":"2026-02-04T04:34:51Z"}]}
{"id":"bd-23b","title":"Add --auto-describe flag to maw ws merge","description":"Add --auto-describe flag to merge that automatically gives empty descriptions to undescribed workspace scaffolding commits, preventing the common 'can\\'t push with empty descriptions' error.\n\nImplementation:\n- Add --auto-describe flag to Merge command\n- After merge, find commits with empty descriptions: 'description(exact:\"\") & ::@- & ~root()'\n- Describe each with 'workspace setup' message\n- Report which commits were auto-described\n\nAcceptance criteria:\n- 'maw ws merge alice bob --auto-describe' fixes empty descriptions\n- Only describes commits that have empty descriptions\n- Reports which commits were auto-described\n- Works correctly with merge commit chain\n- Does nothing if no empty descriptions exist\n\nConfidence: 80% - Practical solution to common annoyance.\n\nReference: notes/ideas.md (Bonus Idea B)","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-02-04T04:31:07.525753102Z","created_by":"maw-dev","updated_at":"2026-02-04T05:32:51.075830440Z","closed_at":"2026-02-04T05:32:51.075811935Z","close_reason":"Completed: --auto-describe flag implemented and pushed (cc2dd71c)","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":21,"issue_id":"bd-23b","author":"maw-dev","text":"Dispatched worker jasper-moss (model: haiku) in workspace keen-forge (/home/bob/src/maw/.workspaces/keen-forge)","created_at":"2026-02-04T05:26:54Z"},{"id":22,"issue_id":"bd-23b","author":"maw-dev","text":"Implementation complete: Added --auto-describe flag that detects and describes empty commits with 'workspace setup' message. Build passes, tests pass.","created_at":"2026-02-04T05:29:38Z"},{"id":23,"issue_id":"bd-23b","author":"maw-dev","text":"Review requested: cr-2zc0, workspace: keen-forge (/home/bob/src/maw/.workspaces/keen-forge)","created_at":"2026-02-04T05:29:46Z"}]}
{"id":"bd-23g","title":"Workspace not destroyed after maw ws merge --destroy","description":"After 'maw ws merge <ws> --destroy -f', the merge appears successful but workspace still exists pointing to the same commit as default. jj workspace list shows both.\n\nReported by claude during agent-loop.sh eval.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-02-03T20:58:19.641768163Z","created_by":"maw-dev","updated_at":"2026-02-03T20:59:53.510578929Z","closed_at":"2026-02-03T20:59:53.510553191Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-23u","title":"maw ws sync --all can cause cascade staleness across workspaces","description":"When an agent runs maw ws sync --all, syncing workspace A can modify shared history in a way that makes workspace B stale again. The agent in the botbus-dev session used maw ws sync --all when only one workspace needed syncing, potentially causing unnecessary churn.\n\nOptions:\n1. Document that --all can cause cascading staleness and recommend syncing only the workspace you're working in\n2. Add a warning when --all is used with multiple workspaces\n3. Sync workspaces in dependency order to minimize cascading\n4. Consider if maw ws sync <name> (single workspace) should be the recommended default in output messages","status":"closed","priority":2,"issue_type":"bug","owner":"maw-dev","created_at":"2026-02-05T22:24:31.019365717Z","created_by":"maw-dev","updated_at":"2026-02-05T22:30:55.539662806Z","closed_at":"2026-02-05T22:30:55.539623292Z","close_reason":"Added cascade staleness re-check after sync --all with actionable warning","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":24,"issue_id":"bd-23u","author":"maw-dev","text":"Implementation pointer: sync --all is handled in src/workspace.rs — search for SyncArgs and the sync command handler. The --all flag iterates all workspaces and runs update-stale on each.","created_at":"2026-02-05T22:25:33Z"}]}
{"id":"bd-25h","title":"Doctor should require .workspaces in .gitignore","description":"maw doctor should check that .workspaces/ (or :/.workspaces) is in .gitignore and warn if not. Without this, workspace directories could accidentally be committed.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T21:16:30.994794139Z","created_by":"bob","updated_at":"2026-01-28T21:22:21.366868450Z","closed_at":"2026-01-28T21:22:21.366852129Z","close_reason":"v0.5.0: init command, doctor gitignore check, default workspace protection","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-26s","title":"Update maw ws merge to use coord workspace","description":"maw ws merge currently runs from repo root (default workspace) and rebases default onto the branch post-merge. In v2, merge runs from coord workspace.\n\nChanges:\n- merge(): replace post-merge 'rebase default workspace onto branch' with 'rebase coord workspace onto branch'\n- merge(): run jj commands with current_dir set to coord workspace path\n- merge(): remove check that we're in repo root / default workspace\n- sync_stale_workspaces_for_merge(): work from coord context\n- After merge, coord workspace on-disk files reflect the merge (same UX benefit as before)\n- Test: merge from ws/coord succeeds, files visible\n- Test: merge from ws/alice fails with error pointing to coord\n\nDepends on: bd-56c (remove default special-casing)\nParent epic: bd-z68","status":"closed","priority":2,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T21:49:03.761172517Z","created_by":"maw-dev","updated_at":"2026-02-07T22:10:41.208070324Z","closed_at":"2026-02-07T22:10:41.208005502Z","close_reason":"merge rebases coord, coord protected from destroy","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-26s","depends_on_id":"bd-56c","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-27u","title":"Audit all output for jj familiarity assumptions","description":"Agents using maw are likely encountering jj for the first time. All maw output (--help text, runtime messages, error recovery suggestions) assumes the agent already understands jj concepts like workspaces, working copies, commits, describe vs commit, bookmarks, revsets, and stale state.\n\nAudit every place maw references jj concepts and add brief inline explanations where needed. Examples:\n\n- 'jj describe -m ...' — agents may not know describe updates the current commit's message (vs git commit which creates a new one)\n- 'jj tracks changes automatically' — agents may not know there's no staging area, no git add\n- 'working copy is stale' — agents have no idea what this means\n- 'jj bookmark set main -r @-' — @- syntax, bookmarks vs branches, none of this is obvious\n- Conflict markers in jj vs git — agents may not know these differ\n- 'jj new' — agents don't know this creates a new commit and moves the working copy to it\n\nThe goal: an agent with zero jj knowledge can follow maw output successfully. Each jj concept should get a one-line explanation the first time it appears in a given output context.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T19:08:15.432609236Z","created_by":"bob","updated_at":"2026-01-30T19:23:38.751366207Z","closed_at":"2026-01-30T19:23:38.751297549Z","close_reason":"Audited all output across main.rs, workspace.rs, agents.rs, init.rs, doctor.rs. Added jj primer to root help and AGENTS.md template. Every jj concept (describe, working copy, stale, bookmarks, @-, rebase, abandon, change-id, revsets, conflict markers, no staging area) now has a one-line inline explanation at first appearance. Fixed AGENTS.md template sandbox issues (cd → maw ws jj).","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-28k","title":"Add recommendations to status command for non-ideal states","description":"The default status command should recommend actions when we're not in a perfect state. If everything isn't committed and 'jj git push' doesn't work, the status command should suggest what steps the user should take to get to a clean state.\n\nAcceptance criteria:\n- maw status shows actionable recommendations when workspace is not in ideal state\n- Recommendations guide users toward: all changes committed, bookmarks set, ready to push\n- Cover common scenarios: uncommitted changes, stale workspaces, bookmark issues, unpushed commits","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-03T21:01:56.529323030Z","created_by":"maw-dev","updated_at":"2026-02-03T21:09:33.480497207Z","closed_at":"2026-02-03T21:09:33.480469505Z","close_reason":"Completed: implemented status command recommendations per review cr-wbe0","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":25,"issue_id":"bd-28k","author":"maw-dev","text":"Created from inbox message by bob: @maw-dev let's use the default status command to recommend to an agent what should be done if we're not in a perfect state","created_at":"2026-02-03T21:02:00Z"},{"id":26,"issue_id":"bd-28k","author":"maw-dev","text":"Started in workspace keen-mountain (/home/bob/src/maw/.workspaces/keen-mountain)","created_at":"2026-02-03T21:02:33Z"}]}
{"id":"bd-28w","title":"TUI: Issues panel (optional)","description":"Show beads issues if .beads/ exists. Priority and status indicators. Hide if beads not configured.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-24T17:32:22.787016927Z","created_by":"bob","updated_at":"2026-01-24T18:38:16.230565827Z","closed_at":"2026-01-24T18:38:16.230539578Z","close_reason":"Implemented issues panel with beads integration, priority colors, and status indicators","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-28w","depends_on_id":"bd-328","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-290","title":"TUI: Use green instead of cyan for focused panel","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-24T18:59:07.753126406Z","created_by":"bob","updated_at":"2026-01-24T19:04:11.802202959Z","closed_at":"2026-01-24T19:04:11.802182140Z","close_reason":"Changed FOCUSED color from Cyan to Green in theme.rs","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-29k","title":"Update README.md workspace paths","description":"Change ../maw-alice to .workspaces/alice in Quick Start section","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T15:49:01.036036232Z","created_by":"bob","updated_at":"2026-01-24T15:56:02.620952344Z","closed_at":"2026-01-24T15:56:02.620930803Z","close_reason":"Updated paths to use .workspaces/","source_repo":".","compaction_level":0,"original_size":0,"labels":["docs"]}
{"id":"bd-2c1","title":"Build simulation-based eval framework for maw features","status":"closed","priority":1,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-05T18:45:55.215726109Z","created_by":"maw-dev","updated_at":"2026-02-05T19:31:06.741156897Z","closed_at":"2026-02-05T19:31:06.741129235Z","close_reason":"Framework built: notes/eval-framework.md + notes/eval-harness.sh. Used to run first eval.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2dj","title":"Add session-start section to agent instructions","description":"Add a 'Session Start' section to the maw_instructions() template in agents.rs advising agents to always run 'maw ws sync' and 'maw ws status' at the beginning of a session. Autonomous agents need explicit guidance to check their environment before editing.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T16:56:46.378534524Z","created_by":"bob","updated_at":"2026-01-28T16:57:35.760555520Z","closed_at":"2026-01-28T16:57:35.760531445Z","close_reason":"Added Session Start section and jj log commands to agent instructions template in agents.rs","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2dx","title":"add `ws create --random`","description":"Passing --random should skip the need for <name> and use a random name.\nNames can be generated by the `names` crate (see ~/src/botbus).\nNames should be kebab-case.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-29T22:38:57.804589023Z","created_by":"bob","updated_at":"2026-01-29T22:42:20.182342263Z","closed_at":"2026-01-29T22:42:20.182305985Z","close_reason":"v0.6.0: maw ws create --random generates kebab-case workspace names","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2e1","title":"Prevent divergent commits by creating dedicated commit on workspace create","description":"Change maw ws create to auto-create a new commit owned by the agent, preventing divergent commits when multiple agents work concurrently.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-24T22:23:17.459077822Z","created_by":"bob","updated_at":"2026-01-24T22:25:59.230237586Z","closed_at":"2026-01-24T22:25:59.230219792Z","close_reason":"Implemented: maw ws create now auto-creates dedicated commit for each agent","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2e4","title":"Add maw ws jj subcommand for sandboxed agents","description":"Agents running under Claude Code's sandbox can't persist cd or env vars between Bash calls. Every jj command in a workspace requires 'cd .workspaces/name && jj ...' which is fragile and hard for sandboxes to inspect.\n\nAdd 'maw ws jj <workspace> <args...>' that runs jj with -R pointing at the workspace directory. Only proxies jj — no arbitrary command execution. This avoids security concerns with a general exec wrapper while solving the real pain point.\n\nExample: maw ws jj alice diff, maw ws jj alice log, maw ws jj alice describe -m 'feat: ...'\n\nRejected alternatives:\n- maw ws exec (arbitrary execution, sandbox-opaque)\n- maw ws env (env vars don't persist in Claude Code sandbox)\n- Better docs (structural friction, not a docs gap)","status":"closed","priority":2,"issue_type":"enhancement","created_at":"2026-01-28T18:40:29.453816755Z","created_by":"bob","updated_at":"2026-01-28T19:26:57.550298764Z","closed_at":"2026-01-28T19:26:57.550270742Z","close_reason":"Added maw ws jj subcommand in v0.3.0. Proxies jj into workspace directory without arbitrary exec.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2ef","title":"Simplify workspace merge workflow to reduce jj complexity","description":"## Problem\n\nAgents struggle with the post-merge jj workflow. The `botbus-dev` session from 2026-02-05 shows this clearly:\n\n1. **Confusing commit graph after merge**: `maw ws merge` creates a merge commit with workspace commits as parents. Agent spent multiple iterations trying to understand where their changes were.\n\n2. **Scaffolding commits in ancestry**: Empty \"workspace setup\" commits from `maw ws create` remain in history, causing warnings about undescribed commits.\n\n3. **Squash timeout**: `jj squash --from <commit>` timed out, likely waiting for editor input. Agent had to kill the task.\n\n4. **Manual cleanup required**: Agent eventually used a complex sequence:\n   ```bash\n   jj restore --from pmkoyruy src/cli/hooks.rs  # copy changes manually\n   jj abandon pmkoyruy rnllrkkw                  # clean up orphans\n   jj bookmark set main -r @\n   jj git push\n   ```\n\n## Root Cause\n\nCurrent `maw ws merge` does:\n```bash\njj new ws1@ ws2@ -m \"merge: combine work from ws1, ws2\"\n```\n\nThis creates a merge topology:\n```\n       M (merge commit - empty, just combines parents)\n      /|\n    W1 W2 (workspace commits with actual changes)\n    |  |\n    S1 S2 (scaffolding commits - empty)\n    | /\n   main\n```\n\nAgents then need to figure out how to get changes onto main and push. The graph is confusing and cleanup is error-prone.\n\n## Proposed Solution: Squash-based merge\n\nInstead of creating a merge commit, squash workspace changes directly onto a new commit based on main:\n\n```bash\n# Collect all workspace working copies\nrevs=\"ws1@ | ws2@\"\n\n# Create new commit on main with all workspace changes squashed into it\njj new main -m \"feat: combined changes\"\njj squash --from \"ws1@ | ws2@\" --into @ -m \"merge: combine work from ws1, ws2\"\n```\n\nOr use the experimental `jj squash -o main` option:\n```bash\njj squash --from \"ws1@ | ws2@\" -o main -m \"merge: combine work from ws1, ws2\"\n```\n\nResult:\n```\n    M (new commit with all changes)\n    |\n   main\n```\n\nThis gives a linear history that's easy to understand and push.\n\n## Implementation Options\n\n### Option A: Squash onto new commit (safest)\n```rust\n// 1. Create new empty commit on main\njj new main -m \"merge: ...\"\n\n// 2. Squash workspace changes into it (with -m to avoid editor)\njj squash --from \"ws1@ | ws2@\" --into @ -m \"merge: ...\"\n\n// 3. Abandon empty scaffolding commits\njj abandon <scaffolding>\n```\n\n### Option B: Use experimental squash -o (simplest)\n```rust\n// Single command, but experimental\njj squash --from \"ws1@ | ws2@\" -o main -m \"merge: ...\"\n```\n\n### Option C: Rebase + squash\n```rust\n// 1. Rebase workspace commits onto main\njj rebase -r \"ws1@ | ws2@\" -d main\n\n// 2. Squash them together\njj squash --from \"ws1@ | ws2@\" --into ws1@ -m \"merge: ...\"\n```\n\n## Additional Improvements\n\n### 1. Add `maw ws finish` command\nFull workflow automation:\n```bash\nmaw ws finish <workspace> [--push]\n# Does: sync, merge, move bookmark, push (optional), destroy\n```\n\n### 2. Always use -m flag\nAll jj commands that might open an editor should use -m to provide message directly. The `jj squash` that timed out was likely waiting for an editor.\n\n### 3. Better guidance in merge output\nInstead of just warning about undescribed commits, provide exact commands:\n```\nNext steps:\n  jj bookmark set main -r @    # Move main to this commit\n  jj git push                  # Push to remote\n```\n\n### 4. Auto-cleanup scaffolding\nDetect and abandon empty scaffolding commits automatically:\n```bash\njj abandon \"ancestors(@) & empty() & description(exact:'') & ~root()\"\n```\n\n## Research Notes\n\nFrom `jj help squash`:\n- `--into` specifies destination (default: @)\n- `--from` specifies source(s)\n- `-m` provides message without editor\n- `-o/--onto` (experimental) creates new commit at specified location\n\nFrom `jj help rebase`:\n- `-r` rebases specific revisions (not descendants)\n- `-d/-o/--onto` specifies destination\n- `--skip-emptied` abandons empty commits after rebase\n\n## Acceptance Criteria\n\n- [ ] `maw ws merge` produces linear history (no merge topology)\n- [ ] No editor prompts during merge\n- [ ] Scaffolding commits cleaned up automatically\n- [ ] Clear next-steps guidance in output\n- [ ] Consider `maw ws finish` for full automation","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-02-05T02:39:18.057714025Z","created_by":"bob","updated_at":"2026-02-05T03:01:18.088025062Z","closed_at":"2026-02-05T03:01:18.087988182Z","close_reason":"Implemented squash-based merge. Eval shows 73% fewer tool uses, 87% faster completion. Agents can now use simple 'maw ws merge <ws> --destroy' without jj complexity.","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":27,"issue_id":"bd-2ef","author":"Bob","text":"## Simulation Testing Approach\n\nCreate eval framework to measure improvement:\n\n### Test Setup\n1. Create /tmp test project with git+jj\n2. Initialize maw and crit\n3. Create workspace with code changes\n4. Create crit review with threads\n5. Approve the review\n\n### Eval: Spawn Sonnet Subagent\nGive minimal prompt: \"Merge the approved review and push to main\"\n\nMeasure:\n- Did they succeed?\n- How many attempts/iterations?\n- What errors did they hit?\n- How much manual intervention needed?\n\n### Before/After Comparison\n1. Run eval with CURRENT maw ws merge\n2. Implement improvements\n3. Run eval with NEW implementation\n4. Compare success rate and iteration count\n\n### Reference\nReal session data: notes/botbus-session-2026-02-04 (botbus-dev struggling with merge)","created_at":"2026-02-05T02:47:06Z"},{"id":28,"issue_id":"bd-2ef","author":"Bob","text":"## Baseline Eval Results (2026-02-05)\n\n### Test Setup\n- Created /tmp/merge-eval with git+jj+maw+crit\n- Created workspace \"test-agent\" with greet() function\n- Created crit review cr-121j with comment thread\n- Approved review\n\n### Subagent Task\nSpawned sonnet with minimal prompt: \"Merge the test-agent workspace changes to main\"\n\n### Results\n- **Tool uses**: 34\n- **Duration**: 218 seconds (~3.6 minutes)\n- **Outcome**: Success, but with workaround\n\n### Key Finding\nAgent said:\n> \"Initial merge attempt: Ran `maw ws merge test-agent` which created a merge commit, but it had an empty scaffolding commit in its ancestry that would have blocked pushing.\"\n\n**Workaround used**: Instead of using the merge commit, agent directly moved bookmark:\n> \"I took a cleaner approach by directly moving the main bookmark to point to the test-agent commit using `jj bookmark set main -r pvvptotq`\"\n\n### Conclusion\nCurrent `maw ws merge` creates a topology that agents work AROUND, not WITH. The agent intuitively found a simpler approach (direct bookmark move) rather than using the merge commit.\n\nThis validates the need for squash-based merge - agents naturally want linear history.","created_at":"2026-02-05T02:52:36Z"},{"id":29,"issue_id":"bd-2ef","author":"Bob","text":"## Implementation Progress\n\n### New squash-based merge implemented and tested\n\n**Algorithm:**\n1. Rebase workspace commits directly onto main: `jj rebase -r \"ws1@ | ws2@\" -d main`\n2. If multiple workspaces, squash into first: `jj squash --from ws2@ --into ws1@ -m \"merge: ...\"`\n3. Move main bookmark automatically\n4. Abandon orphaned scaffolding: `jj abandon \"empty() & description(exact:'') & ~ancestors(main)\"`\n\n**Results:**\n- Before: Merge topology with scaffolding → confusing graph → warnings → manual cleanup\n- After: Linear history → simple graph → no warnings → `jj git push` ready\n\n**Test results:**\n- Single workspace: ✅ Works\n- Multiple workspaces: ✅ Works, both changes combined into single commit\n- Scaffolding: ✅ Automatically cleaned up\n- Output: Simplified to just `Next: jj git push`\n\nReady for post-implementation eval with subagent.","created_at":"2026-02-05T02:57:26Z"},{"id":30,"issue_id":"bd-2ef","author":"Bob","text":"Eval Results - Post-Implementation\n\nBaseline (before squash-based merge):\n- Tool uses: 34\n- Duration: 218s\n- Agent behavior: Worked AROUND merge commit\n\nPost-implementation (squash-based merge):\n- Tool uses: 9\n- Duration: 28s  \n- Agent behavior: Simple maw ws merge test-agent --destroy worked\n\nImprovements:\n- 73% reduction in tool uses (34 to 9)\n- 87% reduction in duration (218s to 28s)\n- Clean workflow: single command produces linear history\n- Scaffolding commits automatically abandoned\n- No agent confusion or workarounds needed\n\nThe simplified merge workflow is a success.","created_at":"2026-02-05T03:01:13Z"}]}
{"id":"bd-2f6","title":"Update AGENTS.md to be consistent","description":"AGENTS.md references old shell script and botbus. Should use maw commands throughout. Remove/update outdated sections.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-24T16:28:48.469562849Z","created_by":"bob","updated_at":"2026-01-24T16:30:57.522558987Z","closed_at":"2026-01-24T16:30:57.522540753Z","close_reason":"Rewrote AGENTS.md to use maw commands, removed deprecated shell script","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2g7","title":"Rename coord workspace to default","status":"closed","priority":1,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T23:14:45.402953434Z","created_by":"maw-dev","updated_at":"2026-02-07T23:45:54.448509376Z","closed_at":"2026-02-07T23:45:54.448475753Z","close_reason":"Shipped in v0.26.1 — coord renamed to default everywhere","source_repo":".","compaction_level":0,"original_size":0,"labels":["cleanup","v2"]}
{"id":"bd-2gc","title":"Remove unused thiserror dependency","description":"thiserror is declared but never used - all error handling uses anyhow","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-24T16:28:45.942471319Z","created_by":"bob","updated_at":"2026-01-24T16:30:09.746229105Z","closed_at":"2026-01-24T16:30:09.746206943Z","close_reason":"Removed unused thiserror dependency","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2gs","title":"Support single-workspace merge","description":"When an agent runs 'maw ws merge <single-ws> --destroy -f', the merge function rejects it ('Only one workspace to merge') and returns early. The --destroy flag never fires, leaving the workspace alive.\n\nFor a single workspace, merge should adopt the workspace's work into default by running 'jj new ws@' (single parent), then optionally destroy the workspace. This is the common case in evals where one agent completes work and the coordinator wants to finalize.\n\nThe current workaround requires manual jj commands which defeats the purpose of maw abstracting workspace management.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-30T15:02:13.916981267Z","created_by":"bob","updated_at":"2026-01-30T15:04:04.945126419Z","closed_at":"2026-01-30T15:04:04.945098115Z","close_reason":"Single-workspace merge now supported. 'maw ws merge <ws> --destroy -f' works with one workspace by adopting its work into default via jj new ws@.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2ia","title":"TUI: Add status bar with key legend","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T18:59:09.214001510Z","created_by":"bob","updated_at":"2026-01-24T19:04:13.736459195Z","closed_at":"2026-01-24T19:04:13.736441442Z","close_reason":"Added lazygit-style status bar with context-sensitive key hints","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2id","title":"maw status command","description":"Add maw status subcommand to summarize jj repo + workspace health, including untracked files, workspace count, git main sync, and push status. Support --oneline and --watch refresh.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-02-01T18:49:04.874526436Z","created_by":"bob","updated_at":"2026-02-01T18:55:55.294898897Z","closed_at":"2026-02-01T18:55:55.294825029Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2id.1","title":"Define maw status output + data points","description":"Decide fields and oneline format for workspace count, untracked files, jj main sync, and git push status.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T18:49:11.388849197Z","created_by":"bob","updated_at":"2026-02-01T18:55:34.902600943Z","closed_at":"2026-02-01T18:55:34.902500375Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-2id.1","depends_on_id":"bd-2id","type":"parent-child","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-2id.2","title":"Implement jj/git status collection","description":"Add logic to gather workspace count, untracked files, and main/push sync state by parsing maw/jj/git commands.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T18:49:13.752701271Z","created_by":"bob","updated_at":"2026-02-01T18:55:42.440433950Z","closed_at":"2026-02-01T18:55:42.440340905Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-2id.2","depends_on_id":"bd-2id","type":"parent-child","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-2id.3","title":"Add --oneline and --watch flags","description":"Implement terse statusbar output and periodic refresh mode.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T18:49:15.853879746Z","created_by":"bob","updated_at":"2026-02-01T18:55:44.653034545Z","closed_at":"2026-02-01T18:55:44.652953413Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-2id.3","depends_on_id":"bd-2id","type":"parent-child","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-2id.4","title":"Document maw status command","description":"Update README or docs with usage, --oneline, --watch examples.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-02-01T18:49:17.944856654Z","created_by":"bob","updated_at":"2026-02-01T18:55:46.408648502Z","closed_at":"2026-02-01T18:55:46.408578361Z","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-2id.4","depends_on_id":"bd-2id","type":"parent-child","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-2ij","title":"ws create should be more explicit in instructions","description":"Due to claude code sandboxing, an agen't can't cd into the workspace and start working. They will have to prefix cd /absolute/path/to/workspace && ... before every singlecommand they run and edit files from the root dir as cwd.\n\nUpdate the text ouput from ws create to show:\n- an example of doing this\n- at least one example of using `maw jj <new-workspace> ...` commands\n- make sure it's clear it's just for jj commands","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-29T23:14:29.588309432Z","created_by":"bob","updated_at":"2026-01-29T23:15:43.335040377Z","closed_at":"2026-01-29T23:15:43.335011463Z","close_reason":"Updated ws create output: shows absolute path, leads with maw ws jj examples, shows cd <path> && ... for non-jj commands, clarifies maw ws jj is jj-only","source_repo":".","compaction_level":0,"original_size":0,"labels":["ux"]}
{"id":"bd-2j7","title":"Add structured output (--format json|toon) to workspace commands","description":"Currently workspace commands (ws list, ws status, ws show) shell to jj and output whatever jj outputs.\n\nProblem: This is not machine-parseable, making it hard for agents and scripts to consume.\n\nInvestigation shows:\n- jj has --template flag for customizing output format\n- jj does NOT have native JSON output\n- jj templates are text-based, not structured data\n\nProposed solution:\nAdd --format flag to workspace commands:\n- maw ws list --format json\n- maw ws list --format toon  \n- maw ws status --format json\n- Default remains human-readable text\n\nImplementation options:\n1. Parse jj output and convert to JSON/TOON (more reliable)\n2. Use custom jj templates that mimic JSON (fragile, not real JSON)\n3. Hybrid: use jj templates to get structured info, then format as JSON/TOON\n\nBenefits:\n- Agents can parse output reliably\n- Scripts can consume workspace state\n- Consistent with crit's --json flag pattern\n- Better agent experience (matches CLAUDE.md principles)\n\nCommands to enhance:\n- ws list\n- ws status  \n- ws show\n- Possibly: ws log (already has jj -T passthrough)","status":"closed","priority":2,"issue_type":"enhancement","created_at":"2026-01-31T22:57:25.465350095Z","created_by":"bob","updated_at":"2026-01-31T23:06:08.376090070Z","closed_at":"2026-01-31T23:06:08.376064292Z","close_reason":"Implemented --format json|toon|text for ws list and ws status commands. Default is toon. Uses toon-format crate for serialization. Resilient to parsing failures - falls back to raw text output.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2ji","title":"Add maw ws attach command","description":"Add 'maw ws attach <name>' to reconnect an orphaned workspace directory (one where 'jj workspace forget' was run but the directory remains) back to jj\\'s workspace tracking.\n\nImplementation:\n- Add Attach subcommand with name and optional --revision args\n- Check directory exists but workspace not tracked\n- Try to detect last known working copy commit from .jj/working_copy/commit_id\n- Re-add workspace via 'jj workspace add'\n- Suggest 'maw ws sync' if stale\n\nAcceptance criteria:\n- 'maw ws attach orphaned' reconnects orphaned directory\n- Detects if workspace already tracked (error)\n- Detects if directory doesn\\'t exist (error with create suggestion)\n- Supports -r/--revision to specify attachment point\n- Shows helpful message on success\n\nConfidence: 70% - Useful recovery tool but .jj/working_copy path may not be stable across jj versions.\n\nReference: notes/ideas.md (Idea 23)","status":"closed","priority":4,"issue_type":"feature","created_at":"2026-02-04T04:31:43.811152963Z","created_by":"maw-dev","updated_at":"2026-02-04T05:56:22.225974130Z","closed_at":"2026-02-04T05:56:22.225950155Z","close_reason":"Merged from fierce-bear workspace, cr-rvme approved by maw-security","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":31,"issue_id":"bd-2ji","author":"maw-dev","text":"Dispatched worker jade-storm (model: sonnet) in workspace fierce-bear (/home/bob/src/maw/.workspaces/fierce-bear)","created_at":"2026-02-04T05:41:43Z"}]}
{"id":"bd-2jo","title":"Improve workspace merge conflict handling and error messages","description":"Feedback from botbus-dev: Had issues with workspace conflict resolution. When merging workspaces that had diverged, jj rebase commands were confusing - particularly understanding when to use @- vs @. Also lost a crit review during workspace destroy and had to recreate it.\n\nAcceptance criteria:\n- maw ws merge provides clearer error messages when conflicts arise\n- Error output explains what jj commands mean (particularly @- vs @ syntax)\n- Consider preventing destroy when there are pending reviews\n- Provide guidance on how to recover from common merge issues","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-02-03T21:40:04.840093041Z","created_by":"maw-dev","updated_at":"2026-02-03T22:14:28.908085178Z","closed_at":"2026-02-03T22:14:28.908043630Z","close_reason":"Completed: improved workspace merge conflict handling and error messages. Fixed path traversal vulnerability in merge(). Review cr-sdsw merged.","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":32,"issue_id":"bd-2jo","author":"maw-dev","text":"Started in workspace ember-river (/home/bob/src/maw/.workspaces/ember-river)","created_at":"2026-02-03T21:40:43Z"},{"id":33,"issue_id":"bd-2jo","author":"maw-dev","text":"Progress: Implemented improvements to merge error handling. Added check_pending_reviews() function, enhanced error messages with jj syntax help, and improved conflict resolution guidance. Build and tests pass.","created_at":"2026-02-03T21:42:54Z"},{"id":34,"issue_id":"bd-2jo","author":"maw-dev","text":"Review requested: cr-ylk3, workspace: ember-river (/home/bob/src/maw/.workspaces/ember-river)","created_at":"2026-02-03T21:43:06Z"},{"id":35,"issue_id":"bd-2jo","author":"maw-dev","text":"Fixed security issue: Added workspace name validation in merge() function to prevent path traversal attacks. Now validates each workspace name before any file operations.","created_at":"2026-02-03T22:04:15Z"},{"id":36,"issue_id":"bd-2jo","author":"maw-dev","text":"Security fix implemented and code updated. Review cr-sdsw has security thread resolved but blocked vote still active. Awaiting security re-review when maw-security can be respawned (script file issue).","created_at":"2026-02-03T22:06:25Z"},{"id":37,"issue_id":"bd-2jo","author":"maw-dev","text":"Security fix implemented in workspace ember-river (commit babd401a). Validation added to merge() - workspace names checked at function entry. Review cr-sdsw thread th-y94k resolved. Awaiting security re-review to clear block vote.","created_at":"2026-02-03T22:08:29Z"}]}
{"id":"bd-2kd","title":"MAW multi-agent experiment report - botbus inbox features","description":"## MAW Multi-Agent Experiment - Final Report\n\n### Context\nCoordinated 3 parallel agents (wild-warden, electric-junction, iron-bear) working on botbus inbox enhancements using MAW workspaces.\n\n### ✅ What Worked Well\n\n**1. Parallel Execution**\n- All 3 agents completed work concurrently without blocking\n- Time savings: ~7 minutes vs ~20 minutes sequential (~65% faster)\n- No file-locking or coordination problems\n\n**2. Workspace Isolation**\n- Independent work in jj workspaces\n- No interference during development\n- Local testing without affecting main repo\n\n**3. Agent Communication**\n- Successful botbus coordination\n- Proper agent identities maintained\n- Visible progress in central channel\n\n**4. Code Quality**\n- wild-warden: 202 lines (subscription tracking + tests)\n- electric-junction: 218 lines (DM detection + multi-channel)\n- iron-bear: 171 lines (mention detection + hyphen fix)\n- All 113 tests passed after merge\n\n**5. Merge Process**\n- Proper 3-way merge created\n- Clear conflict markers\n- Manageable conflicts (2 files, 4 regions)\n\n### ⚠️ Challenges\n\n**1. Conflict Resolution**\n- Required manual intervention (src/cli/inbox.rs, src/main.rs)\n- Both agents modified same file extensively\n- Conflict markers needed cleanup\n\n**2. Agent Instructions**\n- Required very explicit workspace path instructions\n- Repeated emphasis on export BOTBUS_AGENT needed\n- Workspace navigation not intuitive\n\n**3. Review Process**\n- Difficult to view diffs before merge\n- Non-obvious syntax: jj diff -r <workspace>@\n- No built-in iteration mechanism\n\n**4. Bead Management**\n- Beads updated in workspaces\n- Manual sync needed after merge\n\n### 📊 Metrics\n- Features: 3 major\n- Lines: ~600 total\n- Tests: 113 passing (3 new)\n- Conflicts: 4 regions, 2 files\n- Time: 65% faster than sequential\n\n### 🎯 Recommendations\n\n**Use MAW for:**\n- Independent features touching different files\n- Experiments with multiple approaches\n- Fast parallel development\n\n**Skip MAW for:**\n- Sequential dependent features\n- Single-file refactors (conflict-prone)\n- Quick fixes\n\n### Final Verdict\nSuccess! MAW worked as intended. Conflicts were manageable. Would use again for independent features.","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-28T18:40:00.089415974Z","created_by":"bob","updated_at":"2026-01-28T18:57:30.511437865Z","closed_at":"2026-01-28T18:57:30.511404342Z","close_reason":"Informational experiment report — good data, no action needed","source_repo":".","compaction_level":0,"original_size":0,"labels":["experiment","feedback","multi-agent"]}
{"id":"bd-2kn","title":"Eval: post-merge file visibility + maw push + configurable branch","status":"closed","priority":1,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-05T18:45:58.853466228Z","created_by":"maw-dev","updated_at":"2026-02-05T19:31:06.798184519Z","closed_at":"2026-02-05T19:31:06.798159743Z","close_reason":"Eval complete: notes/eval-report-post-merge-push-branch.md. S1 -47% tools, S2 -53% tools, confusion eliminated.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2lj","title":"maw status --watch broken","description":"it looks like it's inserting newlines, but need carriage return","status":"closed","priority":2,"issue_type":"bug","owner":"maw-dev","created_at":"2026-02-08T23:22:44.132672825Z","created_by":"bob","updated_at":"2026-02-08T23:55:10.893943069Z","closed_at":"2026-02-08T23:55:10.893917221Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["status"],"comments":[{"id":67,"issue_id":"bd-2lj","author":"maw-dev","text":"Started in workspace northern-fox (/home/bob/src/maw/ws/northern-fox/)","created_at":"2026-02-08T23:24:39Z"},{"id":68,"issue_id":"bd-2lj","author":"maw-dev","text":"Fix: In render(), when watching=true, replace \\n with \\r\\n in output. Raw terminal mode requires explicit carriage return; plain \\n only moves cursor down.","created_at":"2026-02-08T23:25:24Z"},{"id":69,"issue_id":"bd-2lj","author":"maw-dev","text":"Review created: cr-1qrl in workspace northern-fox","created_at":"2026-02-08T23:25:36Z"}]}
{"id":"bd-2pq","title":"Implement maw ws status command","description":"Single command showing: workspace stale status, other agent work, conflicts, merge state. Consolidates jj status + jj log --all into agent-focused view.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-24T16:12:03.755969438Z","created_by":"bob","updated_at":"2026-01-24T16:14:16.153792800Z","closed_at":"2026-01-24T16:14:16.153771731Z","close_reason":"Implemented status command showing workspace state, agent work, and conflicts","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2px","title":"Add maw exec <ws> -- cmd args for running tools in workspaces","status":"closed","priority":2,"issue_type":"feature","owner":"maw-dev","created_at":"2026-02-07T23:14:48.445260824Z","created_by":"maw-dev","updated_at":"2026-02-08T03:30:02.016672549Z","closed_at":"2026-02-08T03:30:02.016642693Z","close_reason":"Shipped in v0.27.0","source_repo":".","compaction_level":0,"original_size":0,"labels":["v2"]}
{"id":"bd-2qs","title":"Implement maw ws merge command","description":"Simplify merging agent work: maw ws merge alice bob carol - creates merge commit from specified workspaces. Could also support --all to merge everything.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-24T16:12:05.842150002Z","created_by":"bob","updated_at":"2026-01-24T16:22:46.438444273Z","closed_at":"2026-01-24T16:22:46.438425248Z","close_reason":"Implemented merge command with --all and --destroy options","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2qy","title":"Fix ws create to branch from @ instead of main","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-25T14:09:47.873190211Z","created_by":"bob","updated_at":"2026-01-25T14:10:48.604691573Z","closed_at":"2026-01-25T14:10:48.604657289Z","close_reason":"Done: changed default from main to @","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2to","title":"ws create should branch from current working copy, not main","description":"When creating a new workspace with 'maw ws create', the workspace branches from the 'main' bookmark instead of the current working copy (@).\n\nThis causes issues when the orchestrator has uncommitted work that subagents need access to. The workaround is to manually rebase the workspace after creation:\n\n```bash\ncd .workspaces/agent-foo\njj rebase -d <current-change-id>\n```\n\n**Expected behavior:** 'maw ws create foo' should create a workspace branching from @ (current working copy), so agents immediately see the latest state.\n\n**Current behavior:** Workspaces branch from main, requiring manual rebase.\n\n**Discovered in:** botcrit multi-agent coordination experiment","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-25T14:01:02.259011058Z","created_by":"bob","updated_at":"2026-01-25T14:10:43.773274947Z","closed_at":"2026-01-25T14:10:43.773256863Z","close_reason":"Fixed: ws create now branches from @ (current working copy) instead of main","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2uo","title":"Workspace merge workflow is painful with divergent commits and conflicts","description":"## Context\nJust landed two beads (bd-c92, bd-16n) from separate workspaces. The process was painful.\n\n## Issues Encountered\n\n### 1. Divergent commits everywhere\nAfter any operation, commits became divergent (e.g., `zqvyuvxm/0`, `zqvyuvxm/1`, `zqvyuvxm/2`). This made it hard to:\n- Reference commits unambiguously\n- Understand which version was \"current\"\n- Use simple `jj squash --from <change>` commands\n\n### 2. Constant stale workspace errors\nHad to repeatedly run `jj workspace update-stale` between operations. Sometimes it said \"not stale\" but commands still failed with stale errors.\n\n### 3. Conflicts in auxiliary files\nRebasing onto main caused conflicts in:\n- `.crit/reviews/*/events.jsonl` (review event files)\n- `.beads/issues.jsonl` (bead tracking)\n\nThese are append-only logs that shouldn't conflict, but jj sees them as regular files. Had to manually `jj restore --from @-` each one.\n\n### 4. No --force flag on `maw ws destroy`\nHad to pipe \"y\" to confirm destruction. Would be nice to have `--force` or `-y` for scripted workflows.\n\n### 5. Data written in workspaces doesn't propagate\nReviews created in workspace A don't appear in workspace B's `crit reviews list`. Each workspace has its own `.crit/` with divergent state. This caused duplicate reviews to be filed.\n\n## What Would Help\n\n1. **`maw ws merge` that handles the jj complexity** - squash workspace changes onto main, handle divergent commits automatically\n2. **`--force` flag for `maw ws destroy`**\n3. **Guidance on .gitignore patterns** for files that shouldn't cause merge conflicts (event logs, etc.)\n4. **Better divergent commit handling** - maybe auto-abandon old divergent copies?\n\n## Workaround Used\nManual process:\n```bash\ncd .workspaces/foo\njj workspace update-stale\njj restore --from @- <conflicted-files>...\njj rebase -r @ -d main\njj describe -m \"...\"\njj bookmark set main -r @\njj git push\nmaw ws destroy foo\n```","status":"closed","priority":2,"issue_type":"feedback","owner":"maw-dev","created_at":"2026-02-04T22:56:39.775498868Z","created_by":"botcrit-dev","updated_at":"2026-02-04T23:00:37.404234113Z","closed_at":"2026-02-04T23:00:37.404204868Z","close_reason":"Most issues addressed by crit v2 + maw v0.21.1: per-review event logs eliminate .crit conflicts, .beads in auto_resolve, destroy is non-interactive by default. Divergent commit pain may need better docs on workspace ownership model.","source_repo":".","compaction_level":0,"original_size":0,"labels":["feedback","jj"],"comments":[{"id":38,"issue_id":"bd-2uo","author":"Bob","text":"Review of feedback points:\n\n**1. Divergent commits** - Valid pain point. This happens when the same change ID is modified from multiple places. maw should help prevent this by ensuring each workspace works on its own commit. Will investigate if there's a workflow gap.\n\n**2. Stale workspace errors** - Use `maw ws sync` (not raw `jj workspace update-stale`). It handles edge cases better. Also `maw ws sync --all` syncs all workspaces at once.\n\n**3. Conflicts in .crit/ and .beads/** - FIXED in crit v2 and maw v0.21.1:\n- Crit v2 uses per-review event logs (`.crit/reviews/<id>/events.jsonl`) - no more conflicts between workspaces\n- `.beads/**` should be in `auto_resolve_from_main` in `.maw.toml` - maw auto-resolves these on merge\n- We just removed `.crit/**` from auto_resolve because it's no longer needed with crit v2\n\n**4. --force flag** - Already implemented! `maw ws destroy` is non-interactive by default since bd-346. No flag needed. Use `--confirm` if you WANT the prompt.\n\n**5. Data doesn't propagate between workspaces** - This is intentional jj isolation. Each workspace has its own working copy. With crit v2 per-review structure, reviews created in different workspaces won't conflict on merge. The \"duplicate reviews\" issue should be resolved now.\n\n**Summary**: Most of these issues are addressed by crit v2 + maw v0.21.1. The divergent commits issue may need more investigation - could be a docs/workflow gap.","created_at":"2026-02-04T23:00:31Z"}]}
{"id":"bd-2uu","title":"TUI: Use rounded corners for panels","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-24T18:59:07.009211687Z","created_by":"bob","updated_at":"2026-01-24T19:04:10.876300183Z","closed_at":"2026-01-24T19:04:10.876279885Z","close_reason":"Implemented rounded corners using BorderType::Rounded","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2v6","title":"Add pre/post-merge hooks support","description":"Add support for .maw.toml hook configuration that runs commands before and after merge operations.\n\nImplementation:\n- Extend MawConfig with HooksConfig struct\n- Add pre_merge and post_merge arrays to [hooks] section\n- run_hooks() function executes commands sequentially\n- Pre-merge hooks abort merge on non-zero exit\n- Post-merge hooks warn but don\\'t block\n\nConfig example:\n[hooks]\npre_merge = [\"cargo check\", \"cargo test --no-run\"]\npost_merge = [\"echo 'Merge complete'\"]\n\nAcceptance criteria:\n- .maw.toml [hooks] section is parsed\n- Pre-merge hooks run before merge, abort on failure\n- Post-merge hooks run after merge, warn on failure\n- Hook output is shown to user\n- Works without hooks configured (default empty)\n\nConfidence: 75% - Good feature but shell command splitting needs careful implementation.\n\nReference: notes/ideas.md (Idea 20)","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-02-04T04:31:18.749535503Z","created_by":"maw-dev","updated_at":"2026-02-04T05:40:33.052475024Z","closed_at":"2026-02-04T05:40:33.052446671Z","close_reason":"Implemented pre/post-merge hooks support. Review cr-30a3 approved and merged.","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":39,"issue_id":"bd-2v6","author":"maw-dev","text":"Dispatched worker cosmic-pine (model: sonnet) in workspace silver-gateway (/home/bob/src/maw/.workspaces/silver-gateway)","created_at":"2026-02-04T05:26:56Z"},{"id":40,"issue_id":"bd-2v6","author":"maw-dev","text":"Resetting to open: worker dispatch was simulated but not actually executed. Workspace silver-gateway still exists but has no changes.","created_at":"2026-02-04T05:33:16Z"},{"id":41,"issue_id":"bd-2v6","author":"maw-dev","text":"Dispatched worker thunder-wolf (model: sonnet) in workspace frozen-lynx (/home/bob/src/maw/.workspaces/frozen-lynx)","created_at":"2026-02-04T05:34:34Z"},{"id":42,"issue_id":"bd-2v6","author":"maw-dev","text":"Review requested: cr-30a3","created_at":"2026-02-04T05:38:27Z"}]}
{"id":"bd-31p","title":"Add conflict visualization before merge","description":"jj already supports this via 'jj diff -r agent@', but the syntax is non-obvious. Two options: (1) just document 'jj diff -r <name>@' in agent instructions, or (2) add thin wrapper 'maw ws diff <name>' for discoverability. Leaning toward option 2 — low effort, high value for agents who don't know jj workspace syntax.","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-28T18:40:23.935904529Z","created_by":"bob","updated_at":"2026-01-28T20:46:02.660740410Z","closed_at":"2026-01-28T20:46:02.660714822Z","close_reason":"Solved by maw ws jj (v0.3.0). Agents can run 'maw ws jj alice diff' and 'maw ws jj alice status' without knowing jj workspace@ syntax. Cross-workspace conflict preview would require jj features that don't exist yet.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-323","title":"Add persistent coord workspace concept","description":"Introduce ws/coord/ as a persistent coordination workspace.\n\nChanges:\n- maw ws create: auto-create coord if ws/ exists but coord doesn't\n- maw ws destroy: refuse to destroy coord (like current default protection)\n- maw ws list: mark coord workspace specially in output\n- .maw.toml: add coord_workspace config option (default: \"coord\")\n- New helper: coord_workspace_path() → repo_root/ws/coord/\n\ncoord replaces the default workspace's role for merge/push operations. It's never destroyed during --destroy merges. Agents don't work in coord — it's for coordination only.\n\nDepends on: bd-1gp (ws/ rename)\nParent epic: bd-z68","status":"closed","priority":2,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T21:48:41.474332805Z","created_by":"maw-dev","updated_at":"2026-02-07T22:03:38.168321527Z","closed_at":"2026-02-07T22:03:38.168297482Z","close_reason":"Added COORD_WORKSPACE constant, coord_workspace config, protected coord from destruction","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-323","depends_on_id":"bd-1gp","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-328","title":"TUI: Basic scaffold and app loop","description":"Set up ratatui, crossterm, tokio. Create basic app loop with quit handling. Empty panels layout.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-24T17:32:18.761060328Z","created_by":"bob","updated_at":"2026-01-24T18:25:44.174371139Z","closed_at":"2026-01-24T18:25:44.174353747Z","close_reason":"Basic scaffold complete: ratatui setup, app loop, workspaces panel rendering, theme, navigation keys","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-32m","title":"Add comprehensive --help with examples","description":"Detailed help text explaining multi-agent workflow, examples for each command","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T16:04:28.437114166Z","created_by":"bob","updated_at":"2026-01-24T16:07:03.247103326Z","closed_at":"2026-01-24T16:07:03.247077898Z","close_reason":"Added detailed quick start and workflow sections to --help","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-32m","depends_on_id":"bd-3ng","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-345","title":"Add --json flag to list and status commands","description":"Agents need machine-readable output. Add --json to: maw ws list, maw ws status","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-24T16:28:49.631847548Z","created_by":"bob","updated_at":"2026-01-24T16:32:26.097418140Z","closed_at":"2026-01-24T16:32:26.097397331Z","close_reason":"Deferring - will add if needed through real use","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-346","title":"ws destroy should not require interactive confirmation","description":"'maw ws destroy <name>' prompts for confirmation, which doesn't work well in automated/scripted contexts.\n\n```bash\nmaw ws destroy agent-toon\n# About to destroy workspace 'agent-toon'...\n# Continue? [y/N] Aborted.\n```\n\nCurrent workaround: `echo 'y' | maw ws destroy agent-toon`\n\n**Suggestion:** Add a '--force' or '-y' flag to skip confirmation:\n```bash\nmaw ws destroy agent-toon --force\n```\n\n**Discovered in:** botcrit multi-agent coordination experiment","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-25T14:01:16.122247324Z","created_by":"bob","updated_at":"2026-01-25T14:10:44.824810068Z","closed_at":"2026-01-25T14:10:44.824792635Z","close_reason":"Already implemented: use 'maw ws destroy <name> --force' to skip confirmation. Updated AGENTS.md to document this.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-355","title":"Add workspace metadata storage","description":"Add support for storing metadata (owner, notes, tags, task_id) with each workspace via a .maw-meta file, making workspaces self-documenting.\n\nImplementation:\n- Add WorkspaceMeta struct with owner, created_at, notes, tags, task_id\n- Store as TOML in .workspaces/<name>/.maw-meta\n- Add 'maw ws meta' subcommand with show/set/tag/untag actions\n- Auto-create metadata on workspace creation\n- Show metadata in verbose list output\n\nAcceptance criteria:\n- 'maw ws meta alice show' displays workspace metadata\n- 'maw ws meta alice set owner bob' sets owner field\n- 'maw ws meta alice tag feature' adds a tag\n- 'maw ws create' initializes metadata with created_at\n- 'maw ws list -v' shows owner and tags\n\nConfidence: 70% - Nice-to-have feature. Local-only nature limits usefulness for distributed teams.\n\nReference: notes/ideas.md (Idea 25)","status":"closed","priority":4,"issue_type":"feature","created_at":"2026-02-04T04:31:55.344361173Z","created_by":"maw-dev","updated_at":"2026-02-04T05:57:01.693081998Z","closed_at":"2026-02-04T05:57:01.693042855Z","close_reason":"Merged from frost-tower workspace, cr-14x5 approved by maw-security","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":43,"issue_id":"bd-355","author":"maw-dev","text":"Dispatched worker radiant-lion (model: sonnet) in workspace frost-tower (/home/bob/src/maw/.workspaces/frost-tower)","created_at":"2026-02-04T05:41:44Z"},{"id":44,"issue_id":"bd-355","author":"maw-dev","text":"Starting implementation in frost-tower workspace","created_at":"2026-02-04T05:48:05Z"}]}
{"id":"bd-35o","title":"maw ws jj: auto-sync stale workspaces before running commands","description":"When maw ws jj <name> describe is run on a stale workspace, the jj command fails with exit code 1. The v0.25.0 stale warning fires correctly but the agent still has to manually sync and retry.\n\nOptions:\n1. Add --auto-sync flag to maw ws jj that runs sync before the command\n2. Auto-sync by default (may be surprising if sync itself has issues)\n3. At minimum, retry the command after auto-syncing when the command fails due to staleness\n\nObserved: agent sees exit code 1 plus stale warning, then has to run maw ws sync separately and re-run the describe. This costs 2-3 extra tool calls every time.","status":"closed","priority":2,"issue_type":"feature","owner":"maw-dev","created_at":"2026-02-05T22:24:29.677093958Z","created_by":"maw-dev","updated_at":"2026-02-05T22:30:55.601172607Z","closed_at":"2026-02-05T22:30:55.601135126Z","close_reason":"Replaced warn_if_stale with auto_sync_if_stale in maw ws jj — auto-syncs and resolves divergent commits before running commands","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-35o","depends_on_id":"bd-1zd","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}],"comments":[{"id":45,"issue_id":"bd-35o","author":"maw-dev","text":"Implementation pointers: warn_if_stale() is in src/workspace.rs (search for fn warn_if_stale). The maw ws jj handler is run_jj_in_workspace() in the same file. Note: depends on bd-1zd — if sync itself loses work via divergent commits, auto-syncing could make things worse. Fix bd-1zd first, then auto-sync becomes safe.","created_at":"2026-02-05T22:25:33Z"}]}
{"id":"bd-35v","title":"Test full multi-agent workflow","description":"Create 2-3 agent workspaces, have them make concurrent changes, verify jj handles merges correctly","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-24T15:49:02.670613130Z","created_by":"bob","updated_at":"2026-01-24T15:57:50.531853483Z","closed_at":"2026-01-24T15:57:50.531829799Z","close_reason":"Tested: workspace creation, concurrent edits, conflict detection and resolution all working","source_repo":".","compaction_level":0,"original_size":0,"labels":["testing"],"dependencies":[{"issue_id":"bd-35v","depends_on_id":"bd-399","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"bd-35v","depends_on_id":"bd-3iu","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-363","title":"Add maw jj-intro command - jj for git users quick reference","description":"Add 'maw jj-intro' command that provides a concise jj reference for git users. Focus on mental model differences (no staging, always in commit, change IDs vs commit IDs) and answer common questions like 'how do I push to github?'. Use ~/src/ai-docs/tools/jj.md as inspiration but prioritize maw-specific workflows and blessed patterns. Keep it token-efficient. Implementation: new subcommand in Commands enum, simple text output like agents show.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T21:55:48.781443537Z","created_by":"bob","updated_at":"2026-01-30T21:57:12.913516005Z","closed_at":"2026-01-30T21:57:12.913493113Z","close_reason":"Added 'maw jj-intro' command. Provides concise jj reference for git users: mental model (no staging, always in commit, etc), essential command translations, and step-by-step push-to-github workflow. Focused on answering 'how do I get work on main and push?' with maw-specific patterns.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-36c","title":"Remove orphaned maw-test-agent directory","description":"rm -rf ~/src/maw-test-agent - old workspace location outside project","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-24T15:48:58.606341817Z","created_by":"bob","updated_at":"2026-01-24T15:55:49.859655865Z","closed_at":"2026-01-24T15:55:49.859636900Z","close_reason":"Directory removed","source_repo":".","compaction_level":0,"original_size":0,"labels":["cleanup"]}
{"id":"bd-36w","title":"Trim KEEP_ROOT to .git/.jj/ws only","status":"closed","priority":1,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T23:14:46.286271597Z","created_by":"maw-dev","updated_at":"2026-02-07T23:45:55.720769435Z","closed_at":"2026-02-07T23:45:55.720743787Z","close_reason":"Shipped in v0.26.1 — KEEP_ROOT trimmed to .git/.jj/ws","source_repo":".","compaction_level":0,"original_size":0,"labels":["cleanup","v2"]}
{"id":"bd-380","title":"just added new bug for status","description":"just added new bug for status","status":"closed","priority":2,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-08T23:23:33.664822233Z","created_by":"maw-dev","updated_at":"2026-02-08T23:23:52.991977081Z","closed_at":"2026-02-08T23:23:52.991952024Z","close_reason":"Duplicate/placeholder of bd-2lj","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-38e","title":"Add divergent commit detection to maw doctor","description":"## Context\n\nAgents encounter divergent commits and don't know how to diagnose or fix them. `maw doctor` should detect this condition and provide actionable guidance.\n\n## Implementation\n\nIn `maw doctor`, add a check that:\n\n1. Runs `jj log` looking for `(divergent)` markers\n2. If found, warns with specific fix instructions:\n   ```\n   WARNING: Divergent commits detected\n   \n   These commits have multiple versions (usually from modifying the same commit from different places):\n     - abc123 (3 versions)\n   \n   To fix, keep one version and abandon others:\n     jj abandon abc123/0 abc123/1   # keeps abc123/2\n   \n   To prevent: only modify your workspace's working copy commit, never shared commits like main.\n   ```\n\n3. Could also detect if any workspace is pointing at a divergent commit and highlight which one\n\n## Bonus: Runtime warning\n\nConsider adding a check in `maw ws jj` that warns if the command targets a commit outside the workspace's working copy. E.g.:\n\n```bash\nmaw ws jj alice describe main -m \"...\"\n# WARNING: 'main' is not workspace 'alice's commit. This may cause divergence.\n# Continue? [y/N]\n```\n\nThis would catch the footgun before it fires rather than just diagnosing after.","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-02-04T23:08:06.450022454Z","created_by":"bob","updated_at":"2026-02-04T23:19:05.152611233Z","closed_at":"2026-02-04T23:19:05.152592197Z","close_reason":"Implemented runtime warning in maw ws jj when targeting commits outside workspace. Warns for describe/edit/abandon/backout with non-@ revisions.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-399","title":"Forget maw-test-agent workspace from jj","description":"jj workspace forget maw-test-agent - workspace registered but directory is outside project","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-24T15:48:59.792230809Z","created_by":"bob","updated_at":"2026-01-24T15:55:37.320428733Z","closed_at":"2026-01-24T15:55:37.320409507Z","close_reason":"Workspace forgotten from jj","source_repo":".","compaction_level":0,"original_size":0,"labels":["cleanup"]}
{"id":"bd-39e","title":"Remove --all flag from merge command","description":"Remove the --all flag from maw ws merge. It's a footgun - blindly grabs every non-default workspace including ones agents may still be working in. Users should explicitly name the workspaces to merge. Update workspace.rs, agents.rs, AGENTS.md, README.md, main.rs, and TUI app.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-28T17:01:02.655879637Z","created_by":"bob","updated_at":"2026-01-28T17:25:34.420567916Z","closed_at":"2026-01-28T17:25:34.420539032Z","close_reason":"Removed --all flag from merge. Users must name workspaces explicitly. Added --force and confirmation prompt for --destroy. Updated all docs, TUI, and templates.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-39n","title":"Update maw status for bare model","description":"Update maw status and maw ws status to reflect the v2 bare model.\n\nChanges:\n- Remove 'non-default workspaces' wording, just show all workspaces\n- Show coord workspace state: branch position, sync status, conflicts\n- maw status --status-bar: update glyphs for bare model (no default workspace indicator)\n- Warn if repo is v1 (has default workspace) — suggest maw upgrade\n- Show ws/ path in all workspace listings\n\nDepends on: bd-56c (remove default special-casing)\nParent epic: bd-z68","status":"closed","priority":3,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T21:49:35.710893144Z","created_by":"maw-dev","updated_at":"2026-02-07T22:10:41.809848584Z","closed_at":"2026-02-07T22:10:41.809813949Z","close_reason":"status shows Agent workspaces label","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-39n","depends_on_id":"bd-56c","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-39v","title":"Add 'maw ws check-push' command to detect push blockers","description":"Add a command that checks if the current state can be pushed without errors.\n\nChecks:\n- Empty commits in ancestry (jj log -r 'empty() & ::@')\n- Commits without descriptions\n- Whether bookmark needs to be moved before push\n\nOutput:\n- List of issues that would block push\n- Suggested fixes (rebase commands, describe commands)\n- Exit code 0 if ready to push, non-zero if blockers exist\n\nUsage:\n  maw ws check-push\n  maw ws check-push --fix  # Auto-apply fixes if possible\n\nThis prevents the frustrating cycle of 'try push -> fails -> search for solution -> fix -> try again'.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T20:21:10.154235820Z","created_by":"bob","updated_at":"2026-01-28T20:31:45.865437555Z","closed_at":"2026-01-28T20:31:45.865408019Z","close_reason":"Won't build a separate command. The right fix is detecting push blockers at merge time, not adding a pre-push diagnostic. Will add empty commit detection to maw ws merge output instead.","source_repo":".","compaction_level":0,"original_size":0,"labels":["agent-ux","cli"]}
{"id":"bd-39z","title":"Document empty workspace commits as intentional in AGENTS.md","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-25T14:09:49.556411767Z","created_by":"bob","updated_at":"2026-01-25T14:10:49.770980867Z","closed_at":"2026-01-25T14:10:49.770958666Z","close_reason":"Done: updated AGENTS.md and generated instructions","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3a8","title":"Add maw ws history command","description":"Add 'maw ws history <name>' to show a timeline of commits made in that workspace, making it easy to understand what work an agent did and when.\n\nImplementation:\n- Add History subcommand with name and --limit args\n- Use revset '{}@:: & ~::main' to get workspace-specific commits\n- Format with change_id, timestamp, and description\n- Handle empty workspace case gracefully\n\nAcceptance criteria:\n- 'maw ws history alice' shows commits made in alice workspace\n- Shows change_id, timestamp, and description\n- Supports --limit/-n flag for number of commits\n- Reports if workspace has no commits yet\n- Shows helpful tip about 'jj show <change-id>' for details\n\nConfidence: 80% - Concept is solid, revset needs testing for edge cases.\n\nReference: notes/ideas.md (Idea 5)","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-02-04T04:30:55.791437695Z","created_by":"maw-dev","updated_at":"2026-02-04T05:25:24.123076545Z","closed_at":"2026-02-04T05:25:24.123042030Z","close_reason":"Completed: maw ws history command added. Merged via cr-3e40.","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":46,"issue_id":"bd-3a8","author":"maw-dev","text":"Started in workspace wise-beacon (/home/bob/src/maw/.workspaces/wise-beacon)","created_at":"2026-02-04T05:18:51Z"}]}
{"id":"bd-3ac","title":"Add merge and release workflow to AGENTS.md","description":"Adopt the development workflow pattern from botbus AGENTS.md. Replace the sparse 'Finishing Work' and 'Pushing to Remote' sections with a complete merge-and-release workflow covering: merging workspaces, version bumping, bookmark management, pushing, tagging, and verification. Adapt for maw's workspace-based workflow.","status":"closed","priority":2,"issue_type":"docs","created_at":"2026-01-28T16:59:14.956270277Z","created_by":"bob","updated_at":"2026-01-28T17:00:05.145962838Z","closed_at":"2026-01-28T17:00:05.145934786Z","close_reason":"Replaced Finishing Work + Pushing to Remote with full Merging and Releasing workflow in AGENTS.md","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3ax","title":"maw ws list --format json: wrap output in structured envelope with advice array","description":"Currently `maw ws list --format json` emits a bare JSON array to stdout, with warnings (stale workspaces etc.) also going to stdout as plain text. This breaks jq pipelines and machines can miss the warnings.\n\nRestructure JSON output as an envelope:\n\n```json\n{\n  \"workspaces\": [...same array...],\n  \"advice\": [\n    {\n      \"level\": \"warn\",\n      \"message\": \"Stale workspaces\",\n      \"details\": {\n        \"workspaces\": [\"northern-bear\"],\n        \"fix\": \"maw ws sync --all\"\n      }\n    }\n  ]\n}\n```\n\nRules:\n- `advice` is always present (empty array when clean)\n- Warnings never go to stdout as plain text in JSON mode — they go in the advice array\n- Human-readable mode is unchanged (keep the WARNING: line as-is)","status":"closed","priority":3,"issue_type":"feature","owner":"maw-dev","created_at":"2026-02-08T23:41:31.328917037Z","created_by":"maw-dev","updated_at":"2026-02-08T23:57:54.171105133Z","closed_at":"2026-02-08T23:57:54.171077140Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3bl","title":"ws create leaves empty intermediate commits in history","description":"When creating a workspace, maw creates empty intermediate commits that clutter the git history.\n\nLooking at 'jj log' after workspace creation and merge:\n\n```\n○  uplpmxlo ... (empty) (no description set)\n○  nvqtyxmr ... (empty) (no description set)\n```\n\nThese appear to be the 'base' commits created when setting up the workspace before the agent does any work.\n\n**Expected behavior:** Either:\n1. These commits should be squashed away during merge, or\n2. They shouldn't be created in the first place (workspace starts with the agent's first real commit)\n\n**Current behavior:** Empty commits remain in history after merge.\n\n**Discovered in:** botcrit multi-agent coordination experiment","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-25T14:01:09.576168512Z","created_by":"bob","updated_at":"2026-01-25T14:10:45.667920902Z","closed_at":"2026-01-25T14:10:45.667899953Z","close_reason":"By design: empty commits prevent divergence in multi-agent scenarios. Updated AGENTS.md to explain this is intentional.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3bs","title":"Add --dry-run flag to maw ws merge","description":"Add --dry-run flag to maw ws merge that shows what the merge would do without actually creating any commits.\n\nImplementation:\n- Add --dry-run flag to Merge command\n- Early exit in merge() to call preview_merge()\n- preview_merge() shows:\n  - Workspaces to merge\n  - Changes in each workspace (jj diff --stat)\n  - Potential conflicts via jj interdiff\n- Returns without modifying repo state\n\nAcceptance criteria:\n- 'maw ws merge alice bob --dry-run' shows preview without committing\n- Shows file changes from each workspace\n- Warns about potential conflicts\n- Clear message about running without --dry-run to perform merge\n\nConfidence: 85% - Standard feature in merge tools. Main uncertainty is jj interdiff accuracy.\n\nReference: notes/ideas.md (Idea 1)","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-02-04T04:30:19.296318629Z","created_by":"maw-dev","updated_at":"2026-02-04T04:53:03.355390290Z","closed_at":"2026-02-04T04:53:03.355366345Z","close_reason":"Completed: Added --dry-run flag to maw ws merge. Security review passed (LGTM). Pushed to main as 4ac88935.","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":47,"issue_id":"bd-3bs","author":"maw-dev","text":"Started in workspace swift-viper (/home/bob/src/maw/.workspaces/swift-viper)","created_at":"2026-02-04T04:46:14Z"},{"id":48,"issue_id":"bd-3bs","author":"maw-dev","text":"Implementation complete:\n- Added --dry-run flag to maw ws merge\n- preview_merge() shows changes per workspace via jj diff --stat\n- Detects potential conflicts (files modified in multiple workspaces)\n- Tests pass from repo root\n- Ready for security review","created_at":"2026-02-04T04:49:48Z"},{"id":49,"issue_id":"bd-3bs","author":"maw-dev","text":"Review requested: cr-3c2d, workspace: swift-viper (/home/bob/src/maw/.workspaces/swift-viper)","created_at":"2026-02-04T04:50:00Z"}]}
{"id":"bd-3ca","title":"TUI: Add mouse support (click, scroll)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T18:59:08.344141351Z","created_by":"bob","updated_at":"2026-01-24T19:04:12.804097525Z","closed_at":"2026-01-24T19:04:12.804076495Z","close_reason":"Added mouse support: click to select panel/item, scroll wheel for navigation","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3ez","title":"Eval: br/crit/bus tool compatibility in v2 bare model","description":"Verify that beads (br), crit, and bus all work correctly from ws/<name>/ workspaces in the bare model.\n\nSpecific concerns:\n\nbr (beads):\n- br stores data in .beads/issues.jsonl which is tracked in git/jj\n- Does br find .beads/ when run from ws/alice/? (It should — .beads/ is in the workspace working copy)\n- Does br sync --flush-only work from a workspace?\n- Does br create/update/close work?\n- After br modifies .beads/issues.jsonl in ws/alice/, does the change appear in ws/coord/ after merge?\n\ncrit (reviews):\n- crit stores reviews in .crit/ directory\n- Same question: does crit find .crit/ from ws/<name>/?\n- Can an agent create a review from their workspace?\n- Does the review survive merge into coord/main?\n- The incident from botcrit-dev: reviews created in workspace context didn't sync to main. Does v2 make this better or worse?\n\nbus (botbus):\n- bus uses .botbox.json at repo root for config\n- With bare root, .botbox.json only exists inside workspaces\n- Does bus find its config from ws/<name>/?\n- Do bus send/inbox/claims work?\n\nTest method: set up a v2 test repo with .beads/, .crit/, .botbox.json in the initial commit. Run actual tool commands from ws/ workspaces.\n\nIf any tool fails because it can't find its config/data dir from a workspace path, we need to either:\na) Fix the tool to search parent dirs / use jj root\nb) Keep a symlink or copy at repo root\nc) Adjust the bare model\n\nDepends on: bd-3t3 (main eval — run this alongside or after)\nParent epic: bd-z68","status":"closed","priority":1,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T21:50:09.910566584Z","created_by":"maw-dev","updated_at":"2026-02-07T22:23:04.541570322Z","closed_at":"2026-02-07T22:23:04.541536288Z","close_reason":"Eval complete: br from root is invisible to jj — documented as known limitation, recommend running br from workspaces","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-3ez","depends_on_id":"bd-3t3","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-3fw","title":"fix maw ws list/create from bare root","description":"maw ws list and maw ws create fail with 'working copy is stale' from bare root. workspace.rs functions (check_stale_workspaces, create, list_workspaces) use .current_dir(&root) but root has no workspace in v2. Need jj_cwd helper.","status":"closed","priority":1,"issue_type":"bug","owner":"maw-dev","created_at":"2026-02-08T03:37:01.665778360Z","created_by":"maw-dev","updated_at":"2026-02-08T03:53:15.528845726Z","closed_at":"2026-02-08T03:53:15.528828143Z","close_reason":"workspace.rs: all jj commands use jj_cwd(). ws list, create, status, sync, merge, prune, history all work from bare root.","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-3fw","depends_on_id":"bd-162","type":"blocks","created_at":"2026-02-08T03:37:10.312555170Z","created_by":"maw-dev","metadata":"{}","thread_id":""}]}
{"id":"bd-3gn","title":"Support agent iteration/revision workflow","description":"Currently no way for tech lead to request changes from agents after review.\n\nNeeded workflow:\n1. Tech lead reviews workspace\n2. Tech lead creates review feedback (via botbus or maw command)\n3. Agent reads feedback and makes changes in their workspace\n4. Tech lead re-reviews\n5. Approve and merge\n\nCould integrate with crit for formal code review, or build simpler feedback mechanism into maw.\n\nRelated to experiment report bd-2kd","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-28T18:40:26.799645805Z","created_by":"bob","updated_at":"2026-01-28T18:57:36.239449041Z","closed_at":"2026-01-28T18:57:36.239419235Z","close_reason":"Already solved by crit — crit reviews + threads provide the iteration workflow described here","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3iu","title":"Clean up alice workspace","description":"jj workspace forget alice && rm -rf .workspaces/alice - workspace is on root commit, not main","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T15:48:57.795054455Z","created_by":"bob","updated_at":"2026-01-24T15:55:30.392044527Z","closed_at":"2026-01-24T15:55:30.392024860Z","close_reason":"Workspace forgotten and directory removed","source_repo":".","compaction_level":0,"original_size":0,"labels":["cleanup"]}
{"id":"bd-3km","title":"Auto-resolve trivial merge conflicts","description":"When merging workspaces, maw could detect and auto-resolve 'trivial' conflicts where both sides added different non-overlapping lines to the same file.\n\nExample: Two agents both add module declarations to the same file:\n```rust\n// Agent 1 adds:\npub mod drift;\n\n// Agent 2 adds:\npub mod context;\n```\n\nThese are semantically independent additions that could be auto-merged (keep both).\n\n**Current behavior:** Merge fails with conflict markers, requiring manual resolution.\n\n**Suggested behavior:** Detect when conflict is 'both added different lines' and auto-resolve by keeping both additions.\n\nThis might be tricky to implement correctly (need to ensure the additions are truly independent), so marking as an enhancement rather than a bug.\n\n**Discovered in:** botcrit multi-agent coordination - drift and context agents both modified src/jj/mod.rs","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-25T14:23:56.294526610Z","created_by":"bob","updated_at":"2026-01-25T14:29:36.049300420Z","closed_at":"2026-01-25T14:29:36.049281785Z","close_reason":"Won't implement: conflict resolution belongs in jj, not maw. 'Trivial' merges are deceptive - order may matter, semantic independence != syntactic. Better fix is coordination (assign non-overlapping files). Current jj status/diff workflow is sufficient for debugging conflicts.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3m9","title":"maw ws create: ensure trailing / on workspace path in output","description":"When 'maw ws create' outputs the workspace path, it should include a trailing slash for consistency and easier copy-paste into file paths.\n\nAcceptance criteria:\n- Output path ends with / (e.g., /repo/.workspaces/agent-1/)\n- Both human-readable and any structured output formats include trailing slash","status":"closed","priority":3,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-05T19:35:11.942678021Z","created_by":"maw-dev","updated_at":"2026-02-05T21:15:56.566742095Z","closed_at":"2026-02-05T21:15:56.566716406Z","close_reason":"Merged: trailing slash on workspace paths","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":50,"issue_id":"bd-3m9","author":"maw-dev","text":"Dispatched worker iron-moth (model: haiku) in workspace red-panther (/home/bob/src/maw/.workspaces/red-panther)","created_at":"2026-02-05T21:09:29Z"},{"id":51,"issue_id":"bd-3m9","author":"maw-dev","text":"Progress: Completed implementation. Added trailing / to all workspace path outputs in ws create, attach, list --verbose, and prune. Build and tests pass.","created_at":"2026-02-05T21:11:32Z"},{"id":52,"issue_id":"bd-3m9","author":"maw-dev","text":"Review requested: cr-3dru (combined with bd-1bi)","created_at":"2026-02-05T21:13:33Z"}]}
{"id":"bd-3mr","title":"Add implicit rebase to maw ws merge","description":"Currently agents must remember to sync stale workspaces before merge. We should implicitly rebase workspace commits onto current main during merge to avoid conflicts from stale bases.\n\nContext: When a workspace is stale (its base commit is behind main), merging can produce conflicts even when changes don't overlap - just because the workspace is missing intermediate commits from main. This is especially problematic for append-only files like events.jsonl where jj's line-based merge would normally just concatenate.\n\nImplementation:\n- Before squashing workspace commits in maw ws merge, detect if workspace is stale\n- If stale, implicitly rebase workspace commits onto current main bookmark\n- This ensures merge base is current, minimizing spurious conflicts\n- Should work seamlessly - agents don't need to know it happened\n\nRelated: botcrit will add .crit/** to auto_resolve_from_main as additional safety for their append-only event logs.","status":"closed","priority":2,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-06T02:56:30.640980475Z","created_by":"maw-dev","updated_at":"2026-02-06T03:12:18.654941023Z","closed_at":"2026-02-06T03:12:18.654881452Z","close_reason":"Completed - stale workspaces now automatically synced before merge","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":53,"issue_id":"bd-3mr","author":"maw-dev","text":"Started in workspace ember-reef (/home/bob/src/maw/.workspaces/ember-reef/)","created_at":"2026-02-06T03:04:21Z"},{"id":54,"issue_id":"bd-3mr","author":"maw-dev","text":"Implemented sync_stale_workspaces_for_merge() function. Automatically syncs stale workspaces before merge to avoid spurious conflicts. Updated help text.","created_at":"2026-02-06T03:06:59Z"},{"id":55,"issue_id":"bd-3mr","author":"maw-dev","text":"Review requested: cr-fu8d, workspace: ember-reef (/home/bob/src/maw/.workspaces/ember-reef/)","created_at":"2026-02-06T03:07:29Z"},{"id":56,"issue_id":"bd-3mr","author":"maw-dev","text":"Review created: cr-2tof, waiting for security review","created_at":"2026-02-06T03:09:22Z"}]}
{"id":"bd-3ng","title":"Create maw Rust binary scaffold","description":"Initialize Cargo project, basic CLI structure with clap","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-24T16:04:24.159755241Z","created_by":"bob","updated_at":"2026-01-24T16:06:30.401569944Z","closed_at":"2026-01-24T16:06:30.401548845Z","close_reason":"Cargo project initialized with clap CLI","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3nl","title":"Cleanup: bd-3mr merge left beads file conflict","description":"## Situation\n\nbd-3mr (Add implicit rebase to maw ws merge) was successfully merged but left cleanup issues:\n\n1. **Beads file conflict** in .beads/issues.jsonl needs resolution\n2. **Stale claims** may exist for maw-dev, maw-security\n3. **Bead bd-3mr** needs to be closed\n\n## What happened\n\nmaw-dev and maw-security were killed mid-operation after getting into a problematic state:\n- maw-dev had merged the work but got stuck on beads conflict\n- maw-security was reviewing already-merged code\n\n## Cleanup needed\n\n1. Resolve .beads/issues.jsonl conflict (keep in_progress version, then close)\n2. Close bd-3mr with reason \"Completed - implicit rebase feature merged\"\n3. Release any stale claims: `bus claims release --agent maw-dev --all`\n4. Sync beads: `br sync --flush-only`\n\n## Root cause analysis\n\nSee #botbox channel - botbox-dev is analyzing what went wrong with the duplicate reviews and race conditions.","status":"closed","priority":1,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-06T03:13:42.712672593Z","created_by":"botbox-dev","updated_at":"2026-02-06T03:32:53.522527657Z","closed_at":"2026-02-06T03:32:53.522501949Z","close_reason":"not doing (for now)","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3p1","title":"Implement maw ws sync command","description":"Auto-handle stale workspace: run jj workspace update-stale and show what changed. Reduces friction when main repo changes.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-24T16:12:04.914171783Z","created_by":"bob","updated_at":"2026-01-24T16:14:16.663260891Z","closed_at":"2026-01-24T16:14:16.663243038Z","close_reason":"Implemented sync command for handling stale workspaces","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3rz","title":"Add agent guidance for jj bookmark workflow in maw workspaces","description":"## Problem\n\nWhen using maw with jj in colocated repos, agents can successfully create workspaces and make commits, but those commits don't end up on the main branch. This prevents pushing to GitHub and causes confusion.\n\n**Symptoms:**\n- Agent creates workspace: `maw ws create agent-1`\n- Agent makes commits with `jj commit` or `jj describe`\n- When coordinator tries to merge: `maw ws merge --all`\n- Commits exist in jj log but aren't on `main` bookmark\n- Git shows detached HEAD or main hasn't moved\n- `git push` has nothing to push\n\n**Root Cause:**\njj creates commits on a \"floating\" working copy, not directly on bookmarks/branches. After committing, you must explicitly move the `main` bookmark to include your commits:\n\n```bash\njj bookmark set main -r @-  # Move main to parent of working copy\n```\n\n## Proposed Solution\n\nUpdate maw's agent documentation (AGENTS.md or generated guidance) to include jj bookmark workflow:\n\n### For Subagents (in workspaces)\n- Workspaces already isolate work, so subagents don't need to worry about bookmarks\n- Their commits get merged by coordinator\n\n### For Coordinator/Main Workspace\nAfter merging workspaces:\n\n```bash\n# After maw ws merge --all\njj bookmark set main -r @-    # Move main to include merged commit\njj git push                    # Push to GitHub\n```\n\n### Documentation Additions\n\n1. **Quick Start section** - Add jj first-time setup:\n   ```bash\n   jj bookmark track main --remote=origin  # One-time setup\n   ```\n\n2. **Workflow examples** - Show full commit-to-push flow:\n   ```bash\n   # Make changes\n   jj commit -m \"message\"\n   jj bookmark set main -r @-\n   jj git push\n   ```\n\n3. **Troubleshooting section** - How to recover if bookmark wasn't moved\n\n## Benefits\n- Agents won't lose work due to bookmark confusion\n- Clear path from workspace merge → GitHub push\n- Prevents accumulation of orphaned commits\n- Works consistently across projects using jj + maw\n\n## See Also\n- botbus AGENTS.md has similar guidance (lines 77-129)\n- jj tutorial: https://martinvonz.github.io/jj/latest/bookmarks/","status":"closed","priority":2,"issue_type":"enhancement","created_at":"2026-01-26T20:47:35.489967703Z","created_by":"bob","updated_at":"2026-01-26T20:50:48.324829152Z","closed_at":"2026-01-26T20:50:48.324804786Z","close_reason":"Done: Added 'Pushing to Remote' section to AGENTS.md with bookmark workflow, troubleshooting tips. Updated maw ws merge to show push instructions. Updated generated instructions.","source_repo":".","compaction_level":0,"original_size":0,"labels":["agent-ux","docs"]}
{"id":"bd-3t3","title":"Eval: agent workspace lifecycle on v2 bare model","description":"Run actual subagent simulations against a v2 bare-model test repo to verify the full workspace lifecycle works without friction.\n\nTest scenarios (each run as an actual Claude subagent with tool access):\n\nS1 - Create workspace and make changes:\n  Agent is told to create a workspace, edit a file, describe the commit.\n  Verify: workspace created in ws/, files editable, jj describe works.\n  Friction check: does the agent get confused by the bare root? Does it try to cd to repo root and edit files there?\n\nS2 - Merge and push:\n  Coord agent merges two agent workspaces, pushes to remote.\n  Verify: merge succeeds, push succeeds, remote has the commits.\n  Friction check: does the agent figure out --bookmark? Does maw push handle it?\n\nS3 - Full beads workflow:\n  Agent runs br ready, claims a bead, creates workspace, does work, closes bead, merges.\n  Verify: full lifecycle completes.\n  Friction check: does br work from ws/<name>/? Do .beads/ paths resolve correctly?\n\nS4 - Stale workspace recovery:\n  Create two agents, have one merge while the other is working. Second agent must sync.\n  Verify: maw ws sync works from ws/<name>/, auto_sync_if_stale triggers.\n  Friction check: does the stale warning mention the right fix command?\n\nS5 - Concurrent agents:\n  Spawn 2-3 agents in parallel workspaces. Each edits different files. Merge all.\n  Verify: no conflicts, merge succeeds, all changes present.\n  Friction check: do agents step on each other? Does anything touch coord unexpectedly?\n\nUse the eval harness pattern from notes/eval-harness.sh: set up a test repo in /tmp with a remote, run agents against it, capture transcripts, count tool_calls/errors/confusion_markers.\n\nCRITICAL: this is the gate for the whole epic. If agents struggle with v2 more than v1, we need to iterate before shipping.\n\nDepends on: bd-xq6 (docs updated — agents read CLAUDE.md)\nParent epic: bd-z68","status":"closed","priority":1,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T21:49:54.564305774Z","created_by":"maw-dev","updated_at":"2026-02-07T22:23:03.017309449Z","closed_at":"2026-02-07T22:23:03.017290393Z","close_reason":"Eval complete: found post-merge stale coord bug, fixed with update-stale + divergent resolution","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-3t3","depends_on_id":"bd-xq6","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-3u4","title":"Implement workspace list command","description":"maw workspace list - show all workspaces with status (stale, active, etc)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T16:04:27.331844638Z","created_by":"bob","updated_at":"2026-01-24T16:06:37.825040922Z","closed_at":"2026-01-24T16:06:37.825015134Z","close_reason":"Implemented in initial scaffold","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-3u4","depends_on_id":"bd-3ng","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-3vl","title":"Eval: head-to-head v1 vs v2 agent friction comparison","description":"Run identical agent scenarios against both v1 and v2 repos and compare friction metrics.\n\nMethod:\n- Set up two test repos: one v1 (.workspaces/, default workspace), one v2 (ws/, bare, coord)\n- Run the same 5 scenarios from bd-3t3 on both\n- For each scenario, measure:\n  - tool_calls: total tool invocations\n  - errors: jj/maw errors encountered\n  - confusion_markers: agent text indicating confusion ('I need to', 'let me try', backtracking)\n  - goal_achieved: boolean\n  - recovery_steps: extra steps needed to recover from errors\n  - time: total wall clock\n\nSuccess criteria:\n- v2 should have FEWER errors and confusion_markers than v1\n- v2 should have equal or fewer tool_calls\n- v2 should have 100% goal_achieved on scenarios that work in v1\n- If v2 is WORSE on any metric, investigate why and iterate\n\nThis is the definitive test. If v2 doesn't measurably reduce agent friction, we need to understand why before shipping.\n\nDepends on: bd-3t3 (v2 eval), bd-3ez (tool compat eval)\nParent epic: bd-z68","status":"closed","priority":1,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T21:50:20.302585966Z","created_by":"maw-dev","updated_at":"2026-02-07T22:24:17.325422250Z","closed_at":"2026-02-07T22:24:17.325391372Z","close_reason":"v2 verified: full workflow pass, 2 critical bugs found and fixed, eval report written to notes/eval-report-v2-bare-model.md","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-3vl","depends_on_id":"bd-3ez","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"bd-3vl","depends_on_id":"bd-3t3","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-56c","title":"Remove default workspace special-casing from all code paths","description":"Eliminate all special-case handling of the \"default\" workspace throughout the codebase.\n\nCurrent code special-cases default in:\n- sync_all(): if ws == \"default\" → use repo root path\n- jj_in_workspace(): maps \"default\" to repo root\n- destroy(): prevents destroying default\n- attach(): prevents attaching to default\n- status.rs: counts \"non-default\" workspaces separately\n- merge(): post-merge rebase targets default workspace\n\nAfter this change:\n- All workspaces live in ws/<name>/ with no exceptions\n- coord takes over default's protective role (can't destroy)\n- No code path maps a workspace name to the repo root\n- The word \"default\" should not appear in workspace logic except maybe as a jj concept in error messages\n\nDepends on: bd-323 (coord workspace)\nParent epic: bd-z68","status":"closed","priority":2,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T21:48:50.632725650Z","created_by":"maw-dev","updated_at":"2026-02-07T22:03:38.229917117Z","closed_at":"2026-02-07T22:03:38.229888153Z","close_reason":"Removed all default workspace special-casing, all workspaces in ws/<name>/","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-56c","depends_on_id":"bd-323","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-8m3","title":"Error with helpful message when mutation commands run from non-root directory","description":"Agents get confused about CWD during evals. All maw commands that mutate state (ws create, ws destroy, ws sync, ws merge, init) should detect when they're not run from the repo root and error with a helpful message pointing to the correct directory. Read-only commands (ws list, ws status, ws jj, doctor, agents show) can work from anywhere since they already handle CWD internally or are informational.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T19:46:00.769969495Z","created_by":"bob","updated_at":"2026-01-30T19:52:14.846284162Z","closed_at":"2026-01-30T19:52:14.846254837Z","close_reason":"Added ensure_repo_root() check to ws create, ws destroy, and ws merge. Shows clear error with CWD, repo root, and cd command when run from wrong directory.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-8yo","title":"fix maw status from repo root","description":"this is what I see:\n\nAgent workspaces: 0 (1 total)\nWorking copy changes: 1 (jj=1, git=0)\nUntracked files (git): none\nMain vs origin: unknown (jj log failed: Error: The working copy is stale (not updated since operation 076d3d04ddc9).\nHint: Run `jj workspace update-stale` to update it.\nSee https://docs.jj-vcs.dev/latest/working-copy/#stale-working-copy for more information.)\nStale workspace: no","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-02-08T03:31:58.199929292Z","created_by":"bob","updated_at":"2026-02-08T03:53:16.996782314Z","closed_at":"2026-02-08T03:53:16.996754161Z","close_reason":"status.rs now uses workspace::jj_cwd(). Removed duplicate repo_root(). main_sync_status passes cwd.","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-8yo","depends_on_id":"bd-162","type":"blocks","created_at":"2026-02-08T03:37:10.418142688Z","created_by":"maw-dev","metadata":"{}","thread_id":""}]}
{"id":"bd-93h","title":"Generate and evaluate project improvement ideas","description":"Generate 30 improvement ideas for the maw project, critically evaluate each one, and document the ones that pass scrutiny with detailed implementation plans.\n\nAcceptance criteria:\n- Generate 30 one-liner ideas for improving the project\n- Critically evaluate each idea, rejecting poor choices with reasoning\n- For ideas that pass: detailed explanation, concrete actionable plan with code snippets, benefits, downsides, confidence level (0-100%)\n- Write result to notes/ideas.md\n\nRequested by: bob via botbus","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T04:15:40.769647517Z","created_by":"maw-dev","updated_at":"2026-02-04T04:24:21.769142108Z","closed_at":"2026-02-04T04:24:21.769105569Z","close_reason":"Completed: notes/ideas.md created with 30 ideas, critical evaluation, and 10 detailed implementation plans","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":57,"issue_id":"bd-93h","author":"maw-dev","text":"Started in workspace radiant-cedar (/home/bob/src/maw/.workspaces/radiant-cedar)","created_at":"2026-02-04T04:15:52Z"},{"id":58,"issue_id":"bd-93h","author":"maw-dev","text":"Completed: Generated 30 ideas, evaluated each, documented 10 passing ideas with detailed implementation plans in notes/ideas.md","created_at":"2026-02-04T04:20:52Z"},{"id":59,"issue_id":"bd-93h","author":"maw-dev","text":"Review requested: cr-2hka, workspace: radiant-cedar (/home/bob/src/maw/.workspaces/radiant-cedar)","created_at":"2026-02-04T04:21:00Z"},{"id":60,"issue_id":"bd-93h","author":"maw-dev","text":"Note: crit review system is broken (bd-1cl). Since this is documentation-only (no code changes), proceeding without formal review.","created_at":"2026-02-04T04:21:19Z"}]}
{"id":"bd-9zr","title":"Add agents subcommand to generate AGENTS.md sections","description":"maw agents init - generates/updates AGENTS.md with workspace instructions","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-24T16:04:29.499413538Z","created_by":"bob","updated_at":"2026-01-24T16:08:04.303450365Z","closed_at":"2026-01-24T16:08:04.303424477Z","close_reason":"Implemented agents init/show commands for AGENTS.md generation","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-9zr","depends_on_id":"bd-3ng","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-c6z","title":"TUI: Commits panel","description":"Show jj log as graph. Highlight commits from selected workspace. Graph characters for merges.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T17:32:20.806234482Z","created_by":"bob","updated_at":"2026-01-24T18:31:56.710368461Z","closed_at":"2026-01-24T18:31:56.710350397Z","close_reason":"Implemented commits panel with jj log parsing, status symbols, navigation","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-c6z","depends_on_id":"bd-328","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-cgp","title":"Update maw push to use --bookmark explicitly","description":"maw push currently relies on jj's default push revset (remote_bookmarks(remote=origin)..@), which only works when @ is on the main branch lineage. In the bare model, push runs from coord workspace where @ is the coord commit, not main.\n\nChanges:\n- push.rs: use jj git push --bookmark <branch> instead of bare jj git push\n- --advance flag: move bookmark to @- of coord workspace before pushing\n- Remove assumption that push runs from default workspace\n- Test: push from coord workspace after merge succeeds\n- Test: push from agent workspace fails with helpful error (should only push from coord)\n\nDepends on: bd-56c (remove default special-casing)\nParent epic: bd-z68","status":"closed","priority":2,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T21:49:03.702340231Z","created_by":"maw-dev","updated_at":"2026-02-07T22:10:38.770150224Z","closed_at":"2026-02-07T22:10:38.770118324Z","close_reason":"push.rs uses --bookmark explicitly","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-cgp","depends_on_id":"bd-56c","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-clq","title":"Protect default workspace from destroy","description":"maw ws destroy default fails with misleading 'does not exist' because it looks for .workspaces/default/. Add an explicit check: if name == 'default', bail with 'Cannot destroy the default workspace'. Same check needed in merge's destroy_workspaces path.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-28T21:16:30.590875046Z","created_by":"bob","updated_at":"2026-01-28T21:22:21.350469503Z","closed_at":"2026-01-28T21:22:21.350442332Z","close_reason":"v0.5.0: init command, doctor gitignore check, default workspace protection","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-d04","title":"Empty commits appear in jj history after workspace merge","description":"After workspace merge, there is an (empty) (no description set) commit between work commits.\n\nExample jj log: polyvlqm feat: Add rate limiting -> xnymqprr (empty) -> pomwlzmv feat: Add GET /status endpoint\n\nThe empty commits should either be squashed out or not created during merge.\n\nReported by claude during agent-loop.sh eval.","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-02-03T20:58:27.685624139Z","created_by":"maw-dev","updated_at":"2026-02-03T20:59:55.768674899Z","closed_at":"2026-02-03T20:59:55.768650122Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-dmg","title":"Add maw ws prune command","description":"Add 'maw ws prune' to clean up orphaned, stale, or empty workspaces in batch.\n\nImplementation:\n- Add Prune subcommand with --force and --empty flags\n- Get jj-known workspaces from 'jj workspace list'\n- Get directories in .workspaces/\n- Detect:\n  - Orphaned: directory exists but workspace forgotten\n  - Missing: workspace tracked but directory missing\n  - Empty (if --empty): workspace with no changes\n- Default: preview mode (show what would be pruned)\n- With --force: actually delete\n\nAcceptance criteria:\n- 'maw ws prune' shows workspaces that would be pruned (preview)\n- 'maw ws prune --force' actually deletes orphaned workspaces\n- 'maw ws prune --empty --force' also removes empty workspaces\n- Never deletes 'default' workspace\n- Reports reason for each pruned workspace\n\nConfidence: 85% - Conservative design (requires --force) covers real maintenance needs.\n\nReference: notes/ideas.md (Idea 17)","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-02-04T04:30:44.537791576Z","created_by":"maw-dev","updated_at":"2026-02-04T05:18:16.347303478Z","closed_at":"2026-02-04T05:18:16.347279994Z","close_reason":"Merged. Review cr-37eb approved with security fixes for symlink traversal vulnerability.","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":61,"issue_id":"bd-dmg","author":"maw-dev","text":"Started in workspace fierce-river (/home/bob/src/maw/.workspaces/fierce-river)","created_at":"2026-02-04T05:05:01Z"},{"id":62,"issue_id":"bd-dmg","author":"maw-dev","text":"Waiting on security review cr-37eb from maw-security (reviewer is active)","created_at":"2026-02-04T05:11:41Z"},{"id":63,"issue_id":"bd-dmg","author":"maw-dev","text":"Addressed security review feedback (cr-37eb): Fixed symlink traversal vulnerability by adding validation and symlink checks. Replied to all 3 review threads. Waiting for re-review.","created_at":"2026-02-04T05:15:56Z"}]}
{"id":"bd-ebr","title":"Auto-sync beads after successful merge","description":"When agents update beads in their workspaces, those changes stay in workspace-local beads files. After merge, need manual 'br sync --flush-only' to export to main repo.\n\nProposed: maw ws merge should optionally run br sync after successful merge.\n\nAdd flag: maw ws merge --sync-beads <agents>\n\nThis would:\n1. Merge workspaces\n2. If successful, run br sync --flush-only  \n3. Show summary of bead changes\n\nRelated to experiment report bd-2kd","status":"closed","priority":3,"issue_type":"enhancement","created_at":"2026-01-28T18:40:28.096289123Z","created_by":"bob","updated_at":"2026-01-28T18:57:42.155395694Z","closed_at":"2026-01-28T18:57:42.155357933Z","close_reason":"Won't fix — beads sync is br's concern, not maw's. Adding --sync-beads breaks separation of concerns. Will add a reminder to merge output instead.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-hdp","title":"maw status --watch should hide cursor","description":"must restore cursor whan killed/finished!","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-02-08T18:36:21.382417223Z","created_by":"bob","updated_at":"2026-02-08T18:43:14.090274785Z","closed_at":"2026-02-08T18:43:14.090240280Z","close_reason":"Hide cursor with crossterm during --watch, restore on q/Esc/Ctrl-C via raw mode + drop guard","source_repo":".","compaction_level":0,"original_size":0,"labels":["status"]}
{"id":"bd-iq1","title":"Add maw init command","description":"Add 'maw init' that: (1) checks jj is initialized or runs jj init, (2) adds .workspaces/ to .gitignore if not present. This is the first command a user runs in a new project. Currently there's no setup step and agents/users have to manually ensure .workspaces is gitignored.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-28T21:16:30.806415190Z","created_by":"bob","updated_at":"2026-01-28T21:22:21.363483724Z","closed_at":"2026-01-28T21:22:21.363466011Z","close_reason":"v0.5.0: init command, doctor gitignore check, default workspace protection","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-j2z","title":"Improve error messages with recovery guidance","description":"Enhance error messages throughout maw to always include a 'To fix:' section with copy-pasteable commands, making recovery obvious for agents.\n\nImplementation:\n- Create error_with_fixes() helper function\n- Format: '{error}\\n\\nTo fix:\\n  {command1}\\n  {command2}'\n- Apply to all user-facing error sites\n- Include relevant commands for each error type\n\nExamples:\n- Workspace exists: 'maw ws destroy <name>' or 'maw ws list'\n- Workspace not found: 'maw ws create <name>' or 'maw ws list'\n- Merge conflict: specific resolution commands\n- Stale workspace: 'maw ws sync' command\n\nAcceptance criteria:\n- All user-facing errors include 'To fix:' section\n- Commands are copy-pasteable (full paths, proper escaping)\n- Error format is consistent across all commands\n- Follows maw's stated output guidelines for agent-friendliness\n\nConfidence: 85% - Directly aligns with maw's stated goal of being agent-friendly.\n\nReference: notes/ideas.md (Bonus Idea A)","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-02-04T04:30:32.295753018Z","created_by":"maw-dev","updated_at":"2026-02-04T05:03:54.419142971Z","closed_at":"2026-02-04T05:03:54.419123514Z","close_reason":"Completed: Added error_with_fix\\!() macro and updated ~20 error sites across workspace.rs, status.rs, format.rs, init.rs. All errors now include 'To fix:' section with copy-pasteable commands. Security review cr-szr4 approved. Pushed as commit a457784.","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":64,"issue_id":"bd-j2z","author":"maw-dev","text":"Started in workspace frozen-pine (/home/bob/src/maw/.workspaces/frozen-pine)","created_at":"2026-02-04T04:54:15Z"},{"id":65,"issue_id":"bd-j2z","author":"maw-dev","text":"Implementation complete: Added error_with_fix\\!() macro and updated ~20 error sites in workspace.rs, status.rs, format.rs, and init.rs. All errors now include 'To fix:' section with copy-pasteable commands. Tests pass.","created_at":"2026-02-04T04:58:55Z"},{"id":66,"issue_id":"bd-j2z","author":"maw-dev","text":"Review requested: cr-szr4, workspace: frozen-pine (/home/bob/src/maw/.workspaces/frozen-pine)","created_at":"2026-02-04T04:59:03Z"}]}
{"id":"bd-kwi","title":"Document --force flag for ws destroy in AGENTS.md","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-25T14:09:48.768303739Z","created_by":"bob","updated_at":"2026-01-25T14:10:49.296763477Z","closed_at":"2026-01-25T14:10:49.296741917Z","close_reason":"Done: updated AGENTS.md and generated instructions","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-mkr","title":"TUI: Help popup and command log","description":"? key shows help popup with keybindings. Command log panel shows recent jj commands executed.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T17:32:25.512420845Z","created_by":"bob","updated_at":"2026-01-24T18:31:57.991566119Z","closed_at":"2026-01-24T18:31:57.991547664Z","close_reason":"Implemented help popup with keybindings reference","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-mkr","depends_on_id":"bd-328","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-p4u","title":"Add maw init with bare repo setup","description":"Update maw init to create bare-model repos by default (or with --bare flag during transition).\n\nNew init flow:\n1. jj git init --colocate (or detect existing git repo)\n2. Add initial content, commit if needed\n3. jj workspace forget default\n4. git config core.bare true\n5. Remove root source files (stale git working tree)\n6. mkdir ws/\n7. jj workspace add ws/coord\n8. Rebase coord onto main branch\n9. Write .gitignore with ws/ entry\n10. Write .maw.toml with default config\n\nDecision needed: should maw init always create bare repos (breaking change) or require --bare flag? Recommendation: always bare for new repos since there's no migration concern. Add --legacy flag if someone wants v1 layout.\n\nOutput must tell agents exactly what happened and what to do next:\n  Initialized maw repo (bare model)\n  Coord workspace: /abs/path/ws/coord/\n  Next: maw ws create <your-name>\n\nDepends on: bd-323 (coord workspace concept)\nParent epic: bd-z68","status":"closed","priority":2,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T21:49:21.128530483Z","created_by":"maw-dev","updated_at":"2026-02-07T22:10:39.511488935Z","closed_at":"2026-02-07T22:10:39.511459259Z","close_reason":"init.rs bare repo setup complete","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-p4u","depends_on_id":"bd-323","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-ptx","title":"maw push: detect unpushed work and add --advance flag","status":"closed","priority":2,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-05T20:53:24.745887700Z","created_by":"maw-dev","updated_at":"2026-02-05T20:57:29.307985434Z","closed_at":"2026-02-05T20:57:29.307957491Z","close_reason":"Implemented --advance flag and unpushed work detection","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-qn6","title":"Make --destroy non-interactive by default","description":"botbox-dev feature request from #maw: Since agents are primary users of 'maw ws merge --destroy' and can't respond to interactive prompts, -f is always required. Make --destroy non-interactive by default. If we want to keep confirmation option for humans, add --interactive or --confirm flag to opt-in to the prompt. Affects: ws destroy and ws merge --destroy.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T16:33:39.955029431Z","created_by":"bob","updated_at":"2026-01-31T16:35:47.536522856Z","closed_at":"2026-01-31T16:35:47.536491246Z","close_reason":"Changed --destroy to be non-interactive by default. Replaced --force flag with --confirm flag. Agents are primary users and can't respond to prompts, so non-interactive is the sensible default. Use --confirm to opt-in to confirmation prompt. Affects: ws destroy and ws merge --destroy.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-v29","title":"Add automated tests","description":"Unit tests for validation, integration tests for workspace lifecycle. Use temp directories for isolation.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-24T16:34:59.881944061Z","created_by":"bob","updated_at":"2026-01-24T16:36:14.246623631Z","closed_at":"2026-01-24T16:36:14.246602862Z","close_reason":"Added integration tests for workspace name validation (8 tests)","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-vc7","title":"update maw doctor","description":"- don't care about br\n- don't care about botbus\n- do care ./ws/default exists and contains the expected repo\n- warn if we're not in sync with origin main? maybe that's status' job\n- when run from root:\n  - don't care about .gitignore\n  - jj shows jj repository: Error: The working copy is stale","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-08T03:28:17.711108675Z","created_by":"bob","updated_at":"2026-02-08T03:33:37.291959034Z","closed_at":"2026-02-08T03:33:37.291921844Z","close_reason":"maw doctor updated for v2 bare repo model","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-wxu","title":"Add workspace name validation","description":"Critical security: workspace names passed directly to jj and used in paths. Add validation: no path separators, no leading dashes, alphanumeric+hyphen+underscore only.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-24T16:28:44.685262528Z","created_by":"bob","updated_at":"2026-01-24T16:30:08.152290787Z","closed_at":"2026-01-24T16:30:08.152265830Z","close_reason":"Added validate_workspace_name() with checks for empty, leading dash, path separators, and alphanumeric enforcement","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-xq6","title":"Update all docs for v2 bare model","description":"Update all documentation to reflect the v2 bare repo model.\n\nFiles to update:\n- CLAUDE.md: workspace commands, paths, quick start, architecture section\n- .workspaces/alice/CLAUDE.md → update path references (this file IS the agent onboarding doc)\n- .agents/botbox/worker-loop.md, finish.md, start.md: workspace commands\n- .agents/botbox/scripts/: any hardcoded .workspaces/ paths\n- README.md: installation/setup instructions if applicable\n- notes/eval-harness.sh: update test repo setup for v2\n\nKey messaging changes:\n- 'cd .workspaces/<name>' → 'cd ws/<name>'\n- 'default workspace' concept gone, replaced by 'coord workspace'\n- maw push replaces manual jj bookmark set + jj git push\n- Agents should never need to know about jj workspaces internals — maw abstracts it\n- Botbox upgrades must use their own workspace, not repo root\n\nDepends on: bd-26s (merge update), bd-cgp (push update)\nParent epic: bd-z68","status":"closed","priority":2,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T21:49:35.651799266Z","created_by":"maw-dev","updated_at":"2026-02-07T22:15:47.307146514Z","closed_at":"2026-02-07T22:15:47.307119313Z","close_reason":"All docs updated: CLAUDE.md, AGENTS.md, README.md, botbox docs, TUI_SPEC.md, agent-loop.mjs","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-xq6","depends_on_id":"bd-26s","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""},{"issue_id":"bd-xq6","depends_on_id":"bd-cgp","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-z68","title":"Bare repo model: maw architecture v2","description":"Restructure maw repos to use a bare-root model where there is no default jj workspace. All work happens in ws/ subdirectories.\n\nKey changes:\n- maw init: creates colocated jj repo, forgets default workspace, creates ws/coord, sets core.bare=true, cleans root\n- ws/ replaces .workspaces/ as the workspace directory\n- ws/coord is a persistent coordination workspace for merge/push operations\n- maw push uses --bookmark explicitly (default revset won't work without default workspace)\n- maw ws merge operates from coord workspace\n- Existing repos get an upgrade path (maw upgrade or script)\n\nMotivation: prevents the class of incidents where multiple processes write to the default workspace simultaneously (see notes/incident-lost-commits-2026-02-05.md). Structurally eliminates the default workspace as a shared mutable surface.\n\nDesign report: notes/bare-repo-architecture-v2.md","status":"closed","priority":1,"issue_type":"task","owner":"maw-dev","created_at":"2026-02-07T21:42:10.714927584Z","created_by":"maw-dev","updated_at":"2026-02-07T22:24:18.716962012Z","closed_at":"2026-02-07T22:24:18.716929711Z","close_reason":"v2 bare repo model complete: all 12 beads closed, 2 critical eval bugs fixed, full workflow verified","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-z68","depends_on_id":"bd-3vl","type":"blocks","created_at":"2026-02-08T03:26:13Z","created_by":"import","metadata":"{}","thread_id":""}]}
{"id":"bd-zmi","title":"maw ws merge leaves work commits orphaned from default","description":"After 'maw ws merge <ws> --destroy -f', work commits exist in jj history but default's working copy isn't descended from them. Project root ends up empty.\n\njj log shows work commits on separate branch from default:\n  ○ ytrymmyx  test(bd-203): Add tests for status endpoint\n  ○ pupsmryx  feat(bd-1jk): Add JSON validation middleware\n  @ wsrmqkzx  (no description set)  ← default working copy (empty!)\n  ◆ zzzzzzzz  root()\n\nReported by botbox-dev. This is a critical merge behavior issue.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-02-03T20:58:12.810936802Z","created_by":"maw-dev","updated_at":"2026-02-03T20:59:46.160433095Z","closed_at":"2026-02-03T20:59:46.160407707Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
