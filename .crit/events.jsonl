{"ts":"2026-02-03T22:03:55.117122840Z","author":"maw-security","event":"ReviewCreated","data":{"review_id":"cr-sdsw","jj_change_id":"opwzunlwuzmkqpyuyslowulkknxpvqqm","initial_commit":"49d89b184cb464d748d3310758a5e9abdadc3428","title":"bd-2jo: Improve workspace merge conflict handling and error messages"}}
{"ts":"2026-02-03T22:04:04.942802515Z","author":"maw-security","event":"ThreadCreated","data":{"thread_id":"th-y94k","review_id":"cr-sdsw","file_path":"src/workspace.rs","selection":{"type":"Line","line":1075},"commit_hash":"49d89b184cb464d748d3310758a5e9abdadc3428"}}
{"ts":"2026-02-03T22:04:04.942857378Z","author":"maw-security","event":"CommentAdded","data":{"comment_id":"c-zjp6","thread_id":"th-y94k","body":"HIGH: Path traversal vulnerability in destroy_workspaces()\n\nAt line 1075, `ws_dir.join(ws)` is used where `ws` comes directly from user input via CLI arguments without validation. The validation function `validate_workspace_name()` exists and is used in `workspace_path()`, but `destroy_workspaces()` bypasses it entirely.\n\n**Attack vector:**\n```bash\nmaw ws merge \"../../../important-directory\" --destroy\n```\n\nThis would construct the path `.workspaces/../../../important-directory` and then call `remove_dir_all()` on it if it exists.\n\n**Fix:** In `merge()` function, validate each workspace name before processing:\n\n```rust\n// At the start of merge(), after ws_to_merge is populated:\nfor ws in &ws_to_merge {\n    validate_workspace_name(ws)?;\n}\n```\n\nOr use `workspace_path()` in `destroy_workspaces()` instead of `ws_dir.join(ws)`."}}
{"ts":"2026-02-03T22:04:08.687239898Z","author":"maw-security","event":"ReviewerVoted","data":{"review_id":"cr-sdsw","vote":"block","reason":"Path traversal vulnerability: workspace names from CLI are not validated before use in file paths in destroy_workspaces(). Attacker could delete arbitrary directories."}}
{"ts":"2026-02-03T22:04:49.324639739Z","author":"maw-dev","event":"CommentAdded","data":{"comment_id":"c-qynv","thread_id":"th-y94k","body":"Fixed: Added workspace name validation at the start of merge() function. Each workspace name is now validated via validate_workspace_name() before any operations. Build and tests pass."}}
{"ts":"2026-02-03T22:04:52.301352651Z","author":"maw-dev","event":"ThreadResolved","data":{"thread_id":"th-y94k"}}
{"ts":"2026-02-03T22:06:13.131622298Z","author":"maw-dev","event":"ReviewerVoted","data":{"review_id":"cr-sdsw","vote":"lgtm"}}
{"ts":"2026-02-03T22:13:17.482568031Z","author":"maw-security","event":"ReviewerVoted","data":{"review_id":"cr-sdsw","vote":"lgtm"}}
{"ts":"2026-02-03T22:14:11.890613958Z","author":"maw-dev","event":"ReviewApproved","data":{"review_id":"cr-sdsw"}}
{"ts":"2026-02-03T22:14:16.114377224Z","author":"maw-dev","event":"ReviewMerged","data":{"review_id":"cr-sdsw","final_commit":"d0670eec9cee686e24d186aefac5070076d5cf57"}}
{"ts":"2026-02-04T04:59:00.251466461Z","author":"maw-dev","event":"ReviewCreated","data":{"review_id":"cr-szr4","jj_change_id":"nytslwxlvnslplzrvyplrqmkwuwpsyun","initial_commit":"2e3574ef7b3cc005eb635dcc4cac1a1d71b06fe6","title":"bd-j2z: Add error_with_fix macro for agent-friendly error messages","description":"Enhances all user-facing errors to include 'To fix:' sections with copy-pasteable commands.\n\nChanges:\n- Add error_with_fix!() macro to workspace.rs, status.rs, format.rs, init.rs  \n- Update ~20 error sites with recovery guidance\n- Format: '{message}\\n\\nTo fix:\\n  {cmd1}\\n  {cmd2}'\n\nExamples of improved errors:\n- 'Workspace name cannot be empty' → now suggests 'maw ws create <name>'\n- 'Workspace already exists' → now suggests 'maw ws destroy' or '--random'\n- 'jj workspace list failed' → now suggests 'maw doctor' and 'jj status'\n\nAll tests pass. Workspace: frozen-pine"}}
{"ts":"2026-02-04T04:59:10.334332078Z","author":"maw-dev","event":"ReviewersRequested","data":{"review_id":"cr-szr4","reviewers":["maw-security"]}}
{"ts":"2026-02-04T05:00:25.329181471Z","author":"maw-security","event":"ReviewerVoted","data":{"review_id":"cr-szr4","vote":"lgtm"}}
{"ts":"2026-02-04T05:00:25.338436435Z","author":"maw-security","event":"ReviewApproved","data":{"review_id":"cr-szr4"}}
{"ts":"2026-02-04T05:38:24.146331432Z","author":"maw-dev","event":"ReviewCreated","data":{"review_id":"cr-30a3","jj_change_id":"wwmlrsvwzwznoklusqmvuxxxxrmootrp","initial_commit":"7d9da53f112bd0afd8899e34c246647db8202014","title":"bd-2v6, bd-10y: Pre/post-merge hooks and stale workspace detection","description":"## Summary\n\nTwo related features to improve maw workspace management:\n\n### bd-2v6: Pre/post-merge hooks support\n- Add [hooks] section to .maw.toml with pre_merge and post_merge command arrays\n- Pre-merge hooks run before merge and abort on failure (non-zero exit)\n- Post-merge hooks run after merge and warn but don't abort\n- Commands executed via 'sh -c' to allow shell features (pipes, redirects)\n- Hook output displayed during execution\n\nConfig example:\n```toml\n[hooks]\npre_merge = [\"cargo check\", \"cargo test --no-run\"]\npost_merge = [\"echo 'Merge complete'\"]\n```\n\n### bd-10y: Automatic stale workspace detection\n- Add check_stale_workspaces() helper that scans all workspaces\n- Add warn_stale_workspaces() to print warning when any are stale\n- Integrated into 'maw ws list' to catch stale state early\n\nOutput example:\n```\nWARNING: 2 workspace(s) stale: alice, bob\n  Fix: maw ws sync --all\n```\n\n## Security considerations\n- pre_merge hook commands come from .maw.toml (repo-controlled config)\n- Similar to git hooks, npm scripts, Makefiles - intentional design\n- Commands execute via 'sh -c' in repo root context"}}
{"ts":"2026-02-04T05:38:30.189184941Z","author":"maw-dev","event":"ReviewersRequested","data":{"review_id":"cr-30a3","reviewers":["maw-security"]}}
{"ts":"2026-02-04T05:39:47.849037185Z","author":"maw-security","event":"ReviewerVoted","data":{"review_id":"cr-30a3","vote":"lgtm"}}
{"ts":"2026-02-04T05:39:47.864342212Z","author":"maw-security","event":"ReviewApproved","data":{"review_id":"cr-30a3"}}
{"ts":"2026-02-04T05:40:03.247371143Z","author":"maw-dev","event":"ReviewMerged","data":{"review_id":"cr-30a3","final_commit":"61c27a1f2f88566a7545c67ff6479851244e6d1a"}}
{"ts":"2026-02-04T05:46:46.468403958Z","author":"maw-dev","event":"ReviewCreated","data":{"review_id":"cr-rvme","jj_change_id":"owulvvvxokqwmvnluwsqmqtkywpntnor","initial_commit":"67e76ee5832fd267fd58f22995b208e8bc428075","title":"bd-2ji: Add maw ws attach command","description":"Adds 'maw ws attach <name>' to reconnect orphaned workspace directories (where 'jj workspace forget' was run but the directory remains) back to jj's workspace tracking.\n\nChanges:\n- Add Attach subcommand with name and optional -r/--revision args\n- Check directory exists but workspace not tracked\n- Preserve local files during reattachment (moves to temp, re-adds workspace, restores files)\n- Show helpful messages on success and errors\n- Fix test issue where workspace_validation tests failed when run from inside a workspace directory\n\nTesting:\n- All 8 workspace validation tests pass\n- Manual testing confirmed attach works with orphaned directories\n- Local files are preserved during reattachment"}}
{"ts":"2026-02-04T05:46:57.228714424Z","author":"maw-dev","event":"ReviewersRequested","data":{"review_id":"cr-rvme","reviewers":["maw-security"]}}
{"ts":"2026-02-04T05:48:41.382142123Z","author":"maw-security","event":"ReviewerVoted","data":{"review_id":"cr-rvme","vote":"lgtm"}}
{"ts":"2026-02-04T05:48:41.398296200Z","author":"maw-security","event":"ReviewApproved","data":{"review_id":"cr-rvme"}}
{"ts":"2026-02-04T05:55:11.203544806Z","author":"maw-dev","event":"ReviewCreated","data":{"review_id":"cr-14x5","jj_change_id":"lpytxmunmpnlmtqqypquqvxksuroxuqx","initial_commit":"b56a5594918e80a56f3fcbdbc4c758ee1c6bed25","title":"bd-355: Add workspace metadata storage","description":"Adds support for storing metadata (owner, notes, tags, task_id) with each workspace via a .maw-meta TOML file.\n\nChanges:\n- Add WorkspaceMeta struct with owner, created_at, notes, tags, task_id\n- Store as TOML in .workspaces/<name>/.maw-meta\n- Add 'maw ws meta' subcommand with show/set/tag/untag actions\n- Auto-create metadata on workspace creation\n- Show metadata (owner, tags) in verbose list output\n\nTesting:\n- All 8 workspace validation tests pass\n- Manual testing confirmed meta commands work"}}
{"ts":"2026-02-04T05:55:18.477665058Z","author":"maw-dev","event":"ReviewersRequested","data":{"review_id":"cr-14x5","reviewers":["maw-security"]}}
{"ts":"2026-02-04T05:56:22.291007398Z","author":"maw-security","event":"ReviewerVoted","data":{"review_id":"cr-14x5","vote":"lgtm"}}
{"ts":"2026-02-04T05:56:22.299485337Z","author":"maw-security","event":"ReviewApproved","data":{"review_id":"cr-14x5"}}
